// Code generated by ailang. DO NOT EDIT.
package sim_gen

import (
	"math"
)

func packColor_impl(c interface{}) interface{} {
	var tmp1 interface{} = FieldGet(c, "r")
	var tmp2 interface{} = MulInt(tmp1, int64(16777216))
	var tmp3 interface{} = FieldGet(c, "g")
	var tmp4 interface{} = MulInt(tmp3, int64(65536))
	var tmp5 interface{} = AddInt(tmp2, tmp4)
	var tmp6 interface{} = FieldGet(c, "b")
	var tmp7 interface{} = MulInt(tmp6, int64(256))
	var tmp8 interface{} = AddInt(tmp5, tmp7)
	var tmp9 interface{} = FieldGet(c, "a")
	return AddInt(tmp8, tmp9)
}

func PackColor(c *Color) int64 {
	return packColor_impl(c).(int64)
}

func colorRocky_impl(_unused0 interface{}) interface{} {
	return &Color{R: int64(180), G: int64(140), B: int64(100), A: int64(255)}
}

func colorRocky() *Color {
	return colorRocky_impl(struct{}{}).(*Color)
}

func colorGasGiant_impl(_unused0 interface{}) interface{} {
	return &Color{R: int64(200), G: int64(170), B: int64(130), A: int64(255)}
}

func colorGasGiant() *Color {
	return colorGasGiant_impl(struct{}{}).(*Color)
}

func colorIceGiant_impl(_unused0 interface{}) interface{} {
	return &Color{R: int64(80), G: int64(120), B: int64(200), A: int64(255)}
}

func colorIceGiant() *Color {
	return colorIceGiant_impl(struct{}{}).(*Color)
}

func colorTerrestrial_impl(_unused0 interface{}) interface{} {
	return &Color{R: int64(80), G: int64(140), B: int64(200), A: int64(255)}
}

func colorTerrestrial() *Color {
	return colorTerrestrial_impl(struct{}{}).(*Color)
}

func colorOcean_impl(_unused0 interface{}) interface{} {
	return &Color{R: int64(40), G: int64(80), B: int64(180), A: int64(255)}
}

func colorOcean() *Color {
	return colorOcean_impl(struct{}{}).(*Color)
}

func colorVolcanic_impl(_unused0 interface{}) interface{} {
	return &Color{R: int64(200), G: int64(80), B: int64(40), A: int64(255)}
}

func colorVolcanic() *Color {
	return colorVolcanic_impl(struct{}{}).(*Color)
}

func colorDwarf_impl(_unused0 interface{}) interface{} {
	return &Color{R: int64(150), G: int64(140), B: int64(130), A: int64(255)}
}

func colorDwarf() *Color {
	return colorDwarf_impl(struct{}{}).(*Color)
}

func planetBaseColor_impl(pt interface{}) interface{} {
	return func() interface{} {
		_scrutinee := pt
		_ = _scrutinee // suppress unused
		_adt := _scrutinee.(*PlanetType)
		switch _adt.Kind {
		case PlanetTypeKindRocky:
			return colorRocky_impl(struct{}{})
		case PlanetTypeKindGasGiant:
			return colorGasGiant_impl(struct{}{})
		case PlanetTypeKindIceGiant:
			return colorIceGiant_impl(struct{}{})
		case PlanetTypeKindTerrestrial:
			return colorTerrestrial_impl(struct{}{})
		case PlanetTypeKindOcean:
			return colorOcean_impl(struct{}{})
		case PlanetTypeKindVolcanic:
			return colorVolcanic_impl(struct{}{})
		case PlanetTypeKindDwarf:
			return colorDwarf_impl(struct{}{})
		default:
			panic("non-exhaustive match")
		}
	}()
}

func PlanetBaseColor(pt *PlanetType) *Color {
	return planetBaseColor_impl(pt).(*Color)
}

func atmoGasGiant_impl(_unused0 interface{}) interface{} {
	return &Color{R: int64(220), G: int64(180), B: int64(140), A: int64(100)}
}

func atmoGasGiant() *Color {
	return atmoGasGiant_impl(struct{}{}).(*Color)
}

func atmoIceGiant_impl(_unused0 interface{}) interface{} {
	return &Color{R: int64(150), G: int64(200), B: int64(255), A: int64(100)}
}

func atmoIceGiant() *Color {
	return atmoIceGiant_impl(struct{}{}).(*Color)
}

func atmosphereTint_impl(planet interface{}) interface{} {
	var tmp10 interface{} = FieldGet(planet, "planetType")
	return func() interface{} {
		_scrutinee := tmp10
		_ = _scrutinee // suppress unused
		_adt := _scrutinee.(*PlanetType)
		switch _adt.Kind {
		case PlanetTypeKindGasGiant:
			return func() interface{} {
				var tmp11 interface{} = atmoGasGiant_impl(struct{}{})
				_ = tmp11 // suppress unused
				return NewOptionSome(tmp11)
			}()
		case PlanetTypeKindIceGiant:
			return func() interface{} {
				var tmp12 interface{} = atmoIceGiant_impl(struct{}{})
				_ = tmp12 // suppress unused
				return NewOptionSome(tmp12)
			}()
		case PlanetTypeKindTerrestrial:
			return FieldGet(planet, "atmosphereColor")
		default:
			return NewOptionNone()
		}
	}()
}

func AtmosphereTint(planet *CelestialPlanet) *Option {
	return atmosphereTint_impl(planet).(*Option)
}

func makePlanet_impl(id interface{}, name interface{}, pType interface{}, dist interface{}, rad interface{}, period interface{}, angle interface{}, rings interface{}, ringCol interface{}, atmoCol interface{}) interface{} {
	return &CelestialPlanet{Id: id.(int64), Name: name.(string), PlanetType: pType.(*PlanetType), OrbitDistance: dist.(float64), Radius: rad.(float64), OrbitalPeriod: period.(float64), CurrentAngle: angle.(float64), HasRings: rings.(bool), RingColor: ringCol.(*Option), AtmosphereColor: atmoCol.(*Option)}
}

func MakePlanet(id int64, name string, pType *PlanetType, dist float64, rad float64, period float64, angle float64, rings bool, ringCol *Option, atmoCol *Option) *CelestialPlanet {
	return makePlanet_impl(id, name, pType, dist, rad, period, angle, rings, ringCol, atmoCol).(*CelestialPlanet)
}

func initSolSystem_impl(_unused0 interface{}) interface{} {
	var planets interface{} = func() interface{} {
		var tmp15 interface{} = makePlanet_impl(int64(0), "Mercury", NewPlanetTypeRocky(), float64(0.39), float64(0.38), float64(0.24), float64(0), false, NewOptionNone(), NewOptionNone())
		_ = tmp15 // suppress unused
		var tmp16 interface{} = &Color{R: int64(255), G: int64(200), B: int64(100), A: int64(150)}
		_ = tmp16 // suppress unused
		var tmp17 interface{} = NewOptionSome(tmp16)
		_ = tmp17 // suppress unused
		var tmp18 interface{} = makePlanet_impl(int64(1), "Venus", NewPlanetTypeRocky(), float64(0.72), float64(0.95), float64(0.62), float64(1.2), false, NewOptionNone(), tmp17)
		_ = tmp18 // suppress unused
		var tmp19 interface{} = &Color{R: int64(100), G: int64(150), B: int64(255), A: int64(100)}
		_ = tmp19 // suppress unused
		var tmp20 interface{} = NewOptionSome(tmp19)
		_ = tmp20 // suppress unused
		var tmp21 interface{} = makePlanet_impl(int64(2), "Earth", NewPlanetTypeTerrestrial(), float64(1), float64(1), float64(1), float64(2.1), false, NewOptionNone(), tmp20)
		_ = tmp21 // suppress unused
		var tmp22 interface{} = &Color{R: int64(200), G: int64(150), B: int64(100), A: int64(50)}
		_ = tmp22 // suppress unused
		var tmp23 interface{} = NewOptionSome(tmp22)
		_ = tmp23 // suppress unused
		var tmp24 interface{} = makePlanet_impl(int64(3), "Mars", NewPlanetTypeRocky(), float64(1.52), float64(0.53), float64(1.88), float64(3.5), false, NewOptionNone(), tmp23)
		_ = tmp24 // suppress unused
		var tmp25 interface{} = makePlanet_impl(int64(4), "Jupiter", NewPlanetTypeGasGiant(), float64(5.2), float64(11.2), float64(11.86), float64(0.8), false, NewOptionNone(), NewOptionNone())
		_ = tmp25 // suppress unused
		var tmp26 interface{} = &Color{R: int64(210), G: int64(190), B: int64(150), A: int64(200)}
		_ = tmp26 // suppress unused
		var tmp27 interface{} = NewOptionSome(tmp26)
		_ = tmp27 // suppress unused
		var tmp28 interface{} = makePlanet_impl(int64(5), "Saturn", NewPlanetTypeGasGiant(), float64(9.5), float64(9.4), float64(29.46), float64(4.2), true, tmp27, NewOptionNone())
		_ = tmp28 // suppress unused
		var tmp29 interface{} = &Color{R: int64(150), G: int64(180), B: int64(200), A: int64(100)}
		_ = tmp29 // suppress unused
		var tmp30 interface{} = NewOptionSome(tmp29)
		_ = tmp30 // suppress unused
		var tmp31 interface{} = makePlanet_impl(int64(6), "Uranus", NewPlanetTypeIceGiant(), float64(19.2), float64(4), float64(84.01), float64(5.1), true, tmp30, NewOptionNone())
		_ = tmp31 // suppress unused
		var tmp32 interface{} = makePlanet_impl(int64(7), "Neptune", NewPlanetTypeIceGiant(), float64(30.1), float64(3.9), float64(164.8), float64(1.9), false, NewOptionNone(), NewOptionNone())
		_ = tmp32 // suppress unused
		return []interface{}{tmp15, tmp18, tmp21, tmp24, tmp25, tmp28, tmp31, tmp32}
	}()
	var tmp13 interface{} = NewStarTypeMainSequence(NewSpectralClassG())
	var tmp14 interface{} = &SystemPos{X: float64(0), Y: float64(0), Z: float64(0)}
	return &StarSystem{Id: int64(0), Name: "Sol", StarType: tmp13.(*StarType), Position: tmp14.(*SystemPos), Planets: ConvertToCelestialPlanetSlice(planets)}
}

func InitSolSystem() *StarSystem {
	return initSolSystem_impl(struct{}{}).(*StarSystem)
}

func twoPi_impl(_unused0 interface{}) interface{} {
	return float64(6.28318530718)
}

func twoPi() float64 {
	return twoPi_impl(struct{}{}).(float64)
}

func modFloat_impl(x interface{}, m interface{}) interface{} {
	if LtFloat(x, float64(0)).(bool) {
		return func() interface{} {
			var tmp34 interface{} = AddFloat(x, m)
			_ = tmp34 // suppress unused
			return modFloat_impl(tmp34, m)
		}()
	} else if GeFloat(x, m).(bool) {
		return func() interface{} {
			var tmp36 interface{} = SubFloat(x, m)
			_ = tmp36 // suppress unused
			return modFloat_impl(tmp36, m)
		}()
	} else {
		return x
	}
}

func modFloat(x float64, m float64) float64 {
	return modFloat_impl(x, m).(float64)
}

func stepPlanetOrbit_impl(planet interface{}, dt interface{}) interface{} {
	var angularVel interface{} = func() interface{} {
		var tmp50 interface{} = twoPi_impl(struct{}{})
		_ = tmp50 // suppress unused
		var tmp51 interface{} = FieldGet(planet, "orbitalPeriod")
		_ = tmp51 // suppress unused
		return DivFloat(tmp50, tmp51)
	}()
	var newAngle interface{} = func() interface{} {
		var tmp46 interface{} = FieldGet(planet, "currentAngle")
		_ = tmp46 // suppress unused
		var tmp47 interface{} = MulFloat(angularVel, dt)
		_ = tmp47 // suppress unused
		var tmp48 interface{} = AddFloat(tmp46, tmp47)
		_ = tmp48 // suppress unused
		var tmp49 interface{} = twoPi_impl(struct{}{})
		_ = tmp49 // suppress unused
		return modFloat_impl(tmp48, tmp49)
	}()
	var tmp37 interface{} = FieldGet(planet, "id")
	var tmp38 interface{} = FieldGet(planet, "name")
	var tmp39 interface{} = FieldGet(planet, "planetType")
	var tmp40 interface{} = FieldGet(planet, "orbitDistance")
	var tmp41 interface{} = FieldGet(planet, "radius")
	var tmp42 interface{} = FieldGet(planet, "orbitalPeriod")
	var tmp43 interface{} = FieldGet(planet, "hasRings")
	var tmp44 interface{} = FieldGet(planet, "ringColor")
	var tmp45 interface{} = FieldGet(planet, "atmosphereColor")
	return &CelestialPlanet{Id: tmp37.(int64), Name: tmp38.(string), PlanetType: tmp39.(*PlanetType), OrbitDistance: tmp40.(float64), Radius: tmp41.(float64), OrbitalPeriod: tmp42.(float64), CurrentAngle: newAngle.(float64), HasRings: tmp43.(bool), RingColor: tmp44.(*Option), AtmosphereColor: tmp45.(*Option)}
}

func StepPlanetOrbit(planet *CelestialPlanet, dt float64) *CelestialPlanet {
	return stepPlanetOrbit_impl(planet, dt).(*CelestialPlanet)
}

func stepPlanetsOrbit_impl(planets interface{}, dt interface{}) interface{} {
	return func() interface{} {
		_scrutinee := planets
		_ = _scrutinee // suppress unused
		if ListLen(_scrutinee) == 0 {
			return []interface{}{}
		} else if ListLen(_scrutinee) >= 1 {
			p := ListHead(_scrutinee)
			_ = p // suppress unused
			rest := ListTail(_scrutinee)
			_ = rest // suppress unused
			return func() interface{} {
				var tmp52 interface{} = stepPlanetOrbit_impl(p, dt)
				_ = tmp52 // suppress unused
				var tmp53 interface{} = stepPlanetsOrbit_impl(rest, dt)
				_ = tmp53 // suppress unused
				return Cons(tmp52, tmp53)
			}()
		} else {
			panic("non-exhaustive match")
		}
	}()
}

func stepPlanetsOrbit(planets []*CelestialPlanet, dt float64) []*CelestialPlanet {
	return ConvertToCelestialPlanetSlice(stepPlanetsOrbit_impl(planets, dt))
}

func stepSystem_impl(system interface{}, dt interface{}) interface{} {
	var updatedPlanets interface{} = func() interface{} {
		var tmp58 interface{} = FieldGet(system, "planets")
		_ = tmp58 // suppress unused
		return stepPlanetsOrbit_impl(tmp58, dt)
	}()
	var tmp54 interface{} = FieldGet(system, "id")
	var tmp55 interface{} = FieldGet(system, "name")
	var tmp56 interface{} = FieldGet(system, "starType")
	var tmp57 interface{} = FieldGet(system, "position")
	return &StarSystem{Id: tmp54.(int64), Name: tmp55.(string), StarType: tmp56.(*StarType), Position: tmp57.(*SystemPos), Planets: ConvertToCelestialPlanetSlice(updatedPlanets)}
}

func StepSystem(system *StarSystem, dt float64) *StarSystem {
	return stepSystem_impl(system, dt).(*StarSystem)
}

func countPlanets_impl(planets interface{}) interface{} {
	return func() interface{} {
		_scrutinee := planets
		_ = _scrutinee // suppress unused
		if ListLen(_scrutinee) == 0 {
			return int64(0)
		} else if ListLen(_scrutinee) >= 1 {
			rest := ListTail(_scrutinee)
			_ = rest // suppress unused
			return func() interface{} {
				var tmp59 interface{} = countPlanets_impl(rest)
				_ = tmp59 // suppress unused
				return AddInt(int64(1), tmp59)
			}()
		} else {
			panic("non-exhaustive match")
		}
	}()
}

func countPlanets(planets []*CelestialPlanet) int64 {
	return countPlanets_impl(planets).(int64)
}

func planetCount_impl(system interface{}) interface{} {
	var tmp60 interface{} = FieldGet(system, "planets")
	return countPlanets_impl(tmp60)
}

func PlanetCount(system *StarSystem) int64 {
	return planetCount_impl(system).(int64)
}

func getPlanetAt_impl(planets interface{}, idx interface{}) interface{} {
	return func() interface{} {
		_scrutinee := planets
		_ = _scrutinee // suppress unused
		if ListLen(_scrutinee) == 0 {
			return NewOptionNone()
		} else if ListLen(_scrutinee) >= 1 {
			p := ListHead(_scrutinee)
			_ = p // suppress unused
			rest := ListTail(_scrutinee)
			_ = rest // suppress unused
			return func() interface{} {
				if EqInt(idx, int64(0)).(bool) {
					return NewOptionSome(p)
				} else {
					return func() interface{} {
						var tmp62 interface{} = SubInt(idx, int64(1))
						_ = tmp62 // suppress unused
						return getPlanetAt_impl(rest, tmp62)
					}()
				}
			}()
		} else {
			panic("non-exhaustive match")
		}
	}()
}

func getPlanetAt(planets []*CelestialPlanet, idx int64) *Option {
	return getPlanetAt_impl(planets, idx).(*Option)
}

func getPlanet_impl(system interface{}, idx interface{}) interface{} {
	var tmp63 interface{} = FieldGet(system, "planets")
	return getPlanetAt_impl(tmp63, idx)
}

func GetPlanet(system *StarSystem, idx int64) *Option {
	return getPlanet_impl(system, idx).(*Option)
}

func planetPosition2D_impl(planet interface{}, scale interface{}) interface{} {
	var x interface{} = func() interface{} {
		var tmp68 interface{} = FieldGet(planet, "currentAngle")
		_ = tmp68 // suppress unused
		var tmp69 interface{} = math.Cos(tmp68.(float64))
		_ = tmp69 // suppress unused
		var tmp70 interface{} = FieldGet(planet, "orbitDistance")
		_ = tmp70 // suppress unused
		var tmp71 interface{} = MulFloat(tmp69, tmp70)
		_ = tmp71 // suppress unused
		return MulFloat(tmp71, scale)
	}()
	var y interface{} = func() interface{} {
		var tmp64 interface{} = FieldGet(planet, "currentAngle")
		_ = tmp64 // suppress unused
		var tmp65 interface{} = math.Sin(tmp64.(float64))
		_ = tmp65 // suppress unused
		var tmp66 interface{} = FieldGet(planet, "orbitDistance")
		_ = tmp66 // suppress unused
		var tmp67 interface{} = MulFloat(tmp65, tmp66)
		_ = tmp67 // suppress unused
		return MulFloat(tmp67, scale)
	}()
	return []interface{}{x, y}
}

func PlanetPosition2D(planet *CelestialPlanet, scale float64) interface{} {
	return planetPosition2D_impl(planet, scale)
}

func renderScreenWidth_impl(_unused0 interface{}) interface{} {
	return float64(1280)
}

func renderScreenWidth() float64 {
	return renderScreenWidth_impl(struct{}{}).(float64)
}

func renderScreenHeight_impl(_unused0 interface{}) interface{} {
	return float64(960)
}

func renderScreenHeight() float64 {
	return renderScreenHeight_impl(struct{}{}).(float64)
}

func layerPlanets_impl(_unused0 interface{}) interface{} {
	return SubInt(int64(0), int64(5))
}

func layerPlanets() int64 {
	return layerPlanets_impl(struct{}{}).(int64)
}

func planetScreenRadius_impl(planet interface{}) interface{} {
	var tmp72 interface{} = FieldGet(planet, "radius")
	var tmp73 interface{} = GtFloat(tmp72, float64(5))
	return func() interface{} {
		_scrutinee := tmp73
		_ = _scrutinee // suppress unused
		switch _scrutinee {
		case true:
			return func() interface{} {
				var tmp74 interface{} = FieldGet(planet, "radius")
				_ = tmp74 // suppress unused
				var tmp75 interface{} = MulFloat(tmp74, float64(2))
				_ = tmp75 // suppress unused
				return AddFloat(float64(15), tmp75)
			}()
		case false:
			return func() interface{} {
				var tmp76 interface{} = FieldGet(planet, "radius")
				_ = tmp76 // suppress unused
				var tmp77 interface{} = MulFloat(tmp76, float64(5))
				_ = tmp77 // suppress unused
				return AddFloat(float64(8), tmp77)
			}()
		default:
			panic("non-exhaustive match")
		}
	}()
}

func planetScreenRadius(planet *CelestialPlanet) float64 {
	return planetScreenRadius_impl(planet).(float64)
}

func renderPlanet2D_impl(planet interface{}, centerX interface{}, centerY interface{}, scale interface{}) interface{} {
	var pos interface{} = planetPosition2D_impl(planet, scale)
	return func() interface{} {
		_scrutinee := pos
		_ = _scrutinee // suppress unused
		if len(_scrutinee.([]interface{})) == 2 {
			px := _scrutinee.([]interface{})[0]
			_ = px // suppress unused
			py := _scrutinee.([]interface{})[1]
			_ = py // suppress unused
			return func() interface{} {
				var screenX interface{} = AddFloat(centerX, px)
				_ = screenX // suppress unused
				var screenY interface{} = SubFloat(centerY, py)
				_ = screenY // suppress unused
				var radius interface{} = planetScreenRadius_impl(planet)
				_ = radius // suppress unused
				var baseColor interface{} = func() interface{} {
					var tmp79 interface{} = FieldGet(planet, "planetType")
					_ = tmp79 // suppress unused
					return planetBaseColor_impl(tmp79)
				}()
				_ = baseColor // suppress unused
				var colorInt interface{} = packColor_impl(baseColor)
				_ = colorInt // suppress unused
				var tmp78 interface{} = layerPlanets_impl(struct{}{})
				_ = tmp78 // suppress unused
				return NewDrawCmdCircleRGBA(screenX.(float64), screenY.(float64), radius.(float64), colorInt.(int64), true, tmp78.(int64))
			}()
		} else {
			panic("non-exhaustive match")
		}
	}()
}

func RenderPlanet2D(planet *CelestialPlanet, centerX float64, centerY float64, scale float64) *DrawCmd {
	return renderPlanet2D_impl(planet, centerX, centerY, scale).(*DrawCmd)
}

func renderPlanetRing_impl(planet interface{}, centerX interface{}, centerY interface{}, scale interface{}) interface{} {
	var tmp80 interface{} = FieldGet(planet, "hasRings")
	return func() interface{} {
		if tmp80.(bool) {
			return func() interface{} {
				var pos interface{} = planetPosition2D_impl(planet, scale)
				_ = pos // suppress unused
				return func() interface{} {
					_scrutinee := pos
					_ = _scrutinee // suppress unused
					if len(_scrutinee.([]interface{})) == 2 {
						px := _scrutinee.([]interface{})[0]
						_ = px // suppress unused
						py := _scrutinee.([]interface{})[1]
						_ = py // suppress unused
						return func() interface{} {
							var screenX interface{} = AddFloat(centerX, px)
							_ = screenX // suppress unused
							var screenY interface{} = SubFloat(centerY, py)
							_ = screenY // suppress unused
							var planetRadius interface{} = planetScreenRadius_impl(planet)
							_ = planetRadius // suppress unused
							var innerRing interface{} = MulFloat(planetRadius, float64(1.5))
							_ = innerRing // suppress unused
							var outerRing interface{} = MulFloat(planetRadius, float64(2.5))
							_ = outerRing // suppress unused
							var ringColor interface{} = func() interface{} {
								var tmp87 interface{} = FieldGet(planet, "ringColor")
								_ = tmp87 // suppress unused
								return func() interface{} {
									_scrutinee := tmp87
									_ = _scrutinee // suppress unused
									_adt := _scrutinee.(*Option)
									switch _adt.Kind {
									case OptionKindSome:
										c := _adt.Some.Value0
										_ = c // suppress unused
										return packColor_impl(c)
									default:
										none := _adt
										_ = none // suppress unused
										return int64(3535748351)
									}
								}()
							}()
							_ = ringColor // suppress unused
							var tmp81 interface{} = layerPlanets_impl(struct{}{})
							_ = tmp81 // suppress unused
							var tmp82 interface{} = SubInt(tmp81, int64(1))
							_ = tmp82 // suppress unused
							var tmp83 interface{} = NewDrawCmdCircleRGBA(screenX.(float64), screenY.(float64), outerRing.(float64), ringColor.(int64), false, tmp82.(int64))
							_ = tmp83 // suppress unused
							var tmp84 interface{} = layerPlanets_impl(struct{}{})
							_ = tmp84 // suppress unused
							var tmp85 interface{} = SubInt(tmp84, int64(1))
							_ = tmp85 // suppress unused
							var tmp86 interface{} = NewDrawCmdCircleRGBA(screenX.(float64), screenY.(float64), innerRing.(float64), ringColor.(int64), false, tmp85.(int64))
							_ = tmp86 // suppress unused
							return []interface{}{tmp83, tmp86}
						}()
					} else {
						panic("non-exhaustive match")
					}
				}()
			}()
		} else {
			return []interface{}{}
		}
	}()
}

func renderPlanetRing(planet *CelestialPlanet, centerX float64, centerY float64, scale float64) []*DrawCmd {
	return ConvertToDrawCmdSlice(renderPlanetRing_impl(planet, centerX, centerY, scale))
}

func concatCmds_impl(a interface{}, b interface{}) interface{} {
	return func() interface{} {
		_scrutinee := a
		_ = _scrutinee // suppress unused
		if ListLen(_scrutinee) == 0 {
			return b
		} else if ListLen(_scrutinee) >= 1 {
			x := ListHead(_scrutinee)
			_ = x // suppress unused
			rest := ListTail(_scrutinee)
			_ = rest // suppress unused
			return func() interface{} {
				var tmp88 interface{} = concatCmds_impl(rest, b)
				_ = tmp88 // suppress unused
				return Cons(x, tmp88)
			}()
		} else {
			panic("non-exhaustive match")
		}
	}()
}

func concatCmds(a []*DrawCmd, b []*DrawCmd) []*DrawCmd {
	return ConvertToDrawCmdSlice(concatCmds_impl(a, b))
}

func renderOrbitalPlanetsRec_impl(planets interface{}, centerX interface{}, centerY interface{}, scale interface{}) interface{} {
	return func() interface{} {
		_scrutinee := planets
		_ = _scrutinee // suppress unused
		if ListLen(_scrutinee) == 0 {
			return []interface{}{}
		} else if ListLen(_scrutinee) >= 1 {
			p := ListHead(_scrutinee)
			_ = p // suppress unused
			rest := ListTail(_scrutinee)
			_ = rest // suppress unused
			return func() interface{} {
				var planetCmd interface{} = renderPlanet2D_impl(p, centerX, centerY, scale)
				_ = planetCmd // suppress unused
				var ringCmds interface{} = renderPlanetRing_impl(p, centerX, centerY, scale)
				_ = ringCmds // suppress unused
				var tmp89 interface{} = []interface{}{planetCmd}
				_ = tmp89 // suppress unused
				var tmp90 interface{} = renderOrbitalPlanetsRec_impl(rest, centerX, centerY, scale)
				_ = tmp90 // suppress unused
				var tmp91 interface{} = concatCmds_impl(ringCmds, tmp90)
				_ = tmp91 // suppress unused
				return concatCmds_impl(tmp89, tmp91)
			}()
		} else {
			panic("non-exhaustive match")
		}
	}()
}

func renderOrbitalPlanetsRec(planets []*CelestialPlanet, centerX float64, centerY float64, scale float64) []*DrawCmd {
	return ConvertToDrawCmdSlice(renderOrbitalPlanetsRec_impl(planets, centerX, centerY, scale))
}

func renderPlanets_impl(system interface{}, centerX interface{}, centerY interface{}, scale interface{}) interface{} {
	var tmp92 interface{} = FieldGet(system, "planets")
	return renderOrbitalPlanetsRec_impl(tmp92, centerX, centerY, scale)
}

func RenderPlanets(system *StarSystem, centerX float64, centerY float64, scale float64) []*DrawCmd {
	return ConvertToDrawCmdSlice(renderPlanets_impl(system, centerX, centerY, scale))
}

func sunColor_impl(_unused0 interface{}) interface{} {
	return &Color{R: int64(255), G: int64(200), B: int64(50), A: int64(255)}
}

func sunColor() *Color {
	return sunColor_impl(struct{}{}).(*Color)
}

func renderSun_impl(centerX interface{}, centerY interface{}) interface{} {
	var tmp93 interface{} = sunColor_impl(struct{}{})
	var tmp94 interface{} = packColor_impl(tmp93)
	var tmp95 interface{} = layerPlanets_impl(struct{}{})
	return NewDrawCmdCircleRGBA(centerX.(float64), centerY.(float64), float64(20), tmp94.(int64), true, tmp95.(int64))
}

func RenderSun(centerX float64, centerY float64) *DrawCmd {
	return renderSun_impl(centerX, centerY).(*DrawCmd)
}

func renderSolarSystem_impl(system interface{}) interface{} {
	var centerX interface{} = func() interface{} {
		var tmp97 interface{} = renderScreenWidth_impl(struct{}{})
		_ = tmp97 // suppress unused
		return DivFloat(tmp97, float64(2))
	}()
	var centerY interface{} = float64(250)
	var scale interface{} = float64(15)
	var sunCmd interface{} = renderSun_impl(centerX, centerY)
	var tmp96 interface{} = renderPlanets_impl(system, centerX, centerY, scale)
	return Cons(sunCmd, tmp96)
}

func RenderSolarSystem(system *StarSystem) []*DrawCmd {
	return ConvertToDrawCmdSlice(renderSolarSystem_impl(system))
}
