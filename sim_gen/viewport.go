// Code generated by ailang. DO NOT EDIT.
package sim_gen

func bridgeDome_impl(centerX interface{}, centerY interface{}, width interface{}, height interface{}, archHeight interface{}, velocity interface{}, viewAngle interface{}) interface{} {
	var tmp1 interface{} = NewViewportShapeShapeDome(centerX.(float64), centerY.(float64), width.(float64), height.(float64), archHeight.(float64))
	var tmp2 interface{} = NewViewportContentContentSpaceView(velocity.(float64), viewAngle.(float64))
	var tmp3 interface{} = NewViewportEffectEffectSRWarp(velocity.(float64))
	var tmp4 interface{} = []interface{}{tmp3}
	var tmp5 interface{} = DivFloat(width, float64(2))
	var tmp6 interface{} = SubFloat(centerX, tmp5)
	var tmp7 interface{} = DivFloat(height, float64(2))
	var tmp8 interface{} = SubFloat(centerY, tmp7)
	return &ViewportDef{Id: "bridge_dome", Shape: tmp1.(*ViewportShape), Content: tmp2.(*ViewportContent), Effects: ConvertToViewportEffectSlice(tmp4), Layer: int64(90), EdgeBlend: float64(0.15), Opacity: float64(1), ScreenX: tmp6.(float64), ScreenY: tmp8.(float64)}
}

func BridgeDome(centerX float64, centerY float64, width float64, height float64, archHeight float64, velocity float64, viewAngle float64) *ViewportDef {
	return bridgeDome_impl(centerX, centerY, width, height, archHeight, velocity, viewAngle).(*ViewportDef)
}

func cabinWindow_impl(x interface{}, y interface{}, width interface{}, height interface{}, density interface{}) interface{} {
	var tmp9 interface{} = NewViewportShapeShapeRect(float64(0), float64(0), width.(float64), height.(float64))
	var tmp10 interface{} = NewViewportContentContentStarfield(density.(float64), true)
	var tmp11 interface{} = []interface{}{}
	return &ViewportDef{Id: "cabin_window", Shape: tmp9.(*ViewportShape), Content: tmp10.(*ViewportContent), Effects: ConvertToViewportEffectSlice(tmp11), Layer: int64(20), EdgeBlend: float64(0.05), Opacity: float64(1), ScreenX: x.(float64), ScreenY: y.(float64)}
}

func CabinWindow(x float64, y float64, width float64, height float64, density float64) *ViewportDef {
	return cabinWindow_impl(x, y, width, height, density).(*ViewportDef)
}

func porthole_impl(centerX interface{}, centerY interface{}, radius interface{}, density interface{}) interface{} {
	var tmp12 interface{} = NewViewportShapeShapeCircle(radius.(float64), radius.(float64), radius.(float64))
	var tmp13 interface{} = NewViewportContentContentStarfield(density.(float64), false)
	var tmp14 interface{} = []interface{}{}
	var tmp15 interface{} = SubFloat(centerX, radius)
	var tmp16 interface{} = SubFloat(centerY, radius)
	return &ViewportDef{Id: "porthole", Shape: tmp12.(*ViewportShape), Content: tmp13.(*ViewportContent), Effects: ConvertToViewportEffectSlice(tmp14), Layer: int64(15), EdgeBlend: float64(0.1), Opacity: float64(0.9), ScreenX: tmp15.(float64), ScreenY: tmp16.(float64)}
}

func Porthole(centerX float64, centerY float64, radius float64, density float64) *ViewportDef {
	return porthole_impl(centerX, centerY, radius, density).(*ViewportDef)
}

func shapeWidth_impl(shape interface{}) interface{} {
	return func() interface{} {
		_scrutinee := shape
		_ = _scrutinee // suppress unused
		_adt := _scrutinee.(*ViewportShape)
		switch _adt.Kind {
		case ViewportShapeKindShapeEllipse:
			rx := _adt.ShapeEllipse.RadiusX
			_ = rx // suppress unused
			return MulFloat(rx, float64(2))
		case ViewportShapeKindShapeCircle:
			r := _adt.ShapeCircle.Radius
			_ = r // suppress unused
			return MulFloat(r, float64(2))
		case ViewportShapeKindShapeRect:
			w := _adt.ShapeRect.Width
			_ = w // suppress unused
			return w
		case ViewportShapeKindShapeDome:
			w := _adt.ShapeDome.Width
			_ = w // suppress unused
			return w
		default:
			panic("non-exhaustive match")
		}
	}()
}

func ShapeWidth(shape *ViewportShape) float64 {
	return shapeWidth_impl(shape).(float64)
}

func shapeHeight_impl(shape interface{}) interface{} {
	return func() interface{} {
		_scrutinee := shape
		_ = _scrutinee // suppress unused
		_adt := _scrutinee.(*ViewportShape)
		switch _adt.Kind {
		case ViewportShapeKindShapeEllipse:
			ry := _adt.ShapeEllipse.RadiusY
			_ = ry // suppress unused
			return MulFloat(ry, float64(2))
		case ViewportShapeKindShapeCircle:
			r := _adt.ShapeCircle.Radius
			_ = r // suppress unused
			return MulFloat(r, float64(2))
		case ViewportShapeKindShapeRect:
			h := _adt.ShapeRect.Height
			_ = h // suppress unused
			return h
		case ViewportShapeKindShapeDome:
			h := _adt.ShapeDome.Height
			_ = h // suppress unused
			return h
		default:
			panic("non-exhaustive match")
		}
	}()
}

func ShapeHeight(shape *ViewportShape) float64 {
	return shapeHeight_impl(shape).(float64)
}

func hasWarp_impl(vp interface{}) interface{} {
	var checkEffect interface{} = func(eff interface{}) interface{} {
		return func() interface{} {
			_scrutinee := eff
			_ = _scrutinee // suppress unused
			_adt := _scrutinee.(*ViewportEffect)
			switch _adt.Kind {
			case ViewportEffectKindEffectSRWarp:
				return true
			default:
				return false
			}
		}()
	}
	var tmp17 interface{} = FieldGet(vp, "effects")
	return func() interface{} {
		_scrutinee := tmp17
		_ = _scrutinee // suppress unused
		if ListLen(_scrutinee) == 0 {
			return false
		} else if ListLen(_scrutinee) >= 1 {
			e := ListHead(_scrutinee)
			_ = e // suppress unused
			return CallFunc(checkEffect, e)
		} else {
			panic("non-exhaustive match")
		}
	}()
}

func HasWarp(vp *ViewportDef) bool {
	return hasWarp_impl(vp).(bool)
}

func warpVelocity_impl(vp interface{}) interface{} {
	var getVel interface{} = func(eff interface{}) interface{} {
		return func() interface{} {
			_scrutinee := eff
			_ = _scrutinee // suppress unused
			_adt := _scrutinee.(*ViewportEffect)
			switch _adt.Kind {
			case ViewportEffectKindEffectSRWarp:
				v := _adt.EffectSRWarp.Velocity
				_ = v // suppress unused
				return v
			default:
				return float64(0)
			}
		}()
	}
	var tmp18 interface{} = FieldGet(vp, "effects")
	return func() interface{} {
		_scrutinee := tmp18
		_ = _scrutinee // suppress unused
		if ListLen(_scrutinee) == 0 {
			return float64(0)
		} else if ListLen(_scrutinee) >= 1 {
			e := ListHead(_scrutinee)
			_ = e // suppress unused
			return CallFunc(getVel, e)
		} else {
			panic("non-exhaustive match")
		}
	}()
}

func WarpVelocity(vp *ViewportDef) float64 {
	return warpVelocity_impl(vp).(float64)
}

func shapeTypeToInt_impl(shape interface{}) interface{} {
	return func() interface{} {
		_scrutinee := shape
		_ = _scrutinee // suppress unused
		_adt := _scrutinee.(*ViewportShape)
		switch _adt.Kind {
		case ViewportShapeKindShapeEllipse:
			return int64(0)
		case ViewportShapeKindShapeCircle:
			return int64(1)
		case ViewportShapeKindShapeRect:
			return int64(2)
		case ViewportShapeKindShapeDome:
			return int64(3)
		default:
			panic("non-exhaustive match")
		}
	}()
}

func shapeTypeToInt(shape *ViewportShape) int64 {
	return shapeTypeToInt_impl(shape).(int64)
}

func shapeToParams_impl(shape interface{}) interface{} {
	return func() interface{} {
		_scrutinee := shape
		_ = _scrutinee // suppress unused
		_adt := _scrutinee.(*ViewportShape)
		switch _adt.Kind {
		case ViewportShapeKindShapeEllipse:
			cx := _adt.ShapeEllipse.CenterX
			_ = cx // suppress unused
			cy := _adt.ShapeEllipse.CenterY
			_ = cy // suppress unused
			rx := _adt.ShapeEllipse.RadiusX
			_ = rx // suppress unused
			ry := _adt.ShapeEllipse.RadiusY
			_ = ry // suppress unused
			return []interface{}{cx, cy, rx, ry, float64(0)}
		case ViewportShapeKindShapeCircle:
			cx := _adt.ShapeCircle.CenterX
			_ = cx // suppress unused
			cy := _adt.ShapeCircle.CenterY
			_ = cy // suppress unused
			r := _adt.ShapeCircle.Radius
			_ = r // suppress unused
			return []interface{}{cx, cy, r, r, float64(0)}
		case ViewportShapeKindShapeRect:
			x := _adt.ShapeRect.X
			_ = x // suppress unused
			y := _adt.ShapeRect.Y
			_ = y // suppress unused
			w := _adt.ShapeRect.Width
			_ = w // suppress unused
			h := _adt.ShapeRect.Height
			_ = h // suppress unused
			return []interface{}{x, y, w, h, float64(0)}
		case ViewportShapeKindShapeDome:
			cx := _adt.ShapeDome.CenterX
			_ = cx // suppress unused
			cy := _adt.ShapeDome.CenterY
			_ = cy // suppress unused
			w := _adt.ShapeDome.Width
			_ = w // suppress unused
			h := _adt.ShapeDome.Height
			_ = h // suppress unused
			arch := _adt.ShapeDome.ArchHeight
			_ = arch // suppress unused
			return []interface{}{cx, cy, w, h, arch}
		default:
			panic("non-exhaustive match")
		}
	}()
}

func shapeToParams(shape *ViewportShape) []float64 {
	return shapeToParams_impl(shape).([]float64)
}

func contentTypeToInt_impl(content interface{}) interface{} {
	return func() interface{} {
		_scrutinee := content
		_ = _scrutinee // suppress unused
		_adt := _scrutinee.(*ViewportContent)
		switch _adt.Kind {
		case ViewportContentKindContentNone:
			return int64(0)
		case ViewportContentKindContentSpaceView:
			return int64(1)
		case ViewportContentKindContentStarfield:
			return int64(2)
		case ViewportContentKindContentSolid:
			return int64(3)
		default:
			panic("non-exhaustive match")
		}
	}()
}

func contentTypeToInt(content *ViewportContent) int64 {
	return contentTypeToInt_impl(content).(int64)
}

func contentToParams_impl(content interface{}) interface{} {
	return func() interface{} {
		_scrutinee := content
		_ = _scrutinee // suppress unused
		_adt := _scrutinee.(*ViewportContent)
		switch _adt.Kind {
		case ViewportContentKindContentNone:
			return []interface{}{float64(0), float64(0), float64(0)}
		case ViewportContentKindContentSpaceView:
			v := _adt.ContentSpaceView.Velocity
			_ = v // suppress unused
			a := _adt.ContentSpaceView.ViewAngle
			_ = a // suppress unused
			return []interface{}{v, a, float64(0)}
		case ViewportContentKindContentStarfield:
			d := _adt.ContentStarfield.Density
			_ = d // suppress unused
			s := _adt.ContentStarfield.Scroll
			_ = s // suppress unused
			return func() interface{} {
				var tmp19 interface{} = func() interface{} {
					if s {
						return float64(1)
					} else {
						return float64(0)
					}
				}()
				_ = tmp19 // suppress unused
				return []interface{}{d, tmp19, float64(0)}
			}()
		case ViewportContentKindContentSolid:
			c := _adt.ContentSolid.Rgba
			_ = c // suppress unused
			return func() interface{} {
				var tmp20 interface{} = IntToFloat(c)
				_ = tmp20 // suppress unused
				return []interface{}{tmp20, float64(0), float64(0)}
			}()
		default:
			panic("non-exhaustive match")
		}
	}()
}

func contentToParams(content *ViewportContent) []float64 {
	return contentToParams_impl(content).([]float64)
}

func effectTypeToInt_impl(effect interface{}) interface{} {
	return func() interface{} {
		_scrutinee := effect
		_ = _scrutinee // suppress unused
		_adt := _scrutinee.(*ViewportEffect)
		switch _adt.Kind {
		case ViewportEffectKindEffectNone:
			return int64(0)
		case ViewportEffectKindEffectSRWarp:
			return int64(1)
		case ViewportEffectKindEffectGRLensing:
			return int64(2)
		case ViewportEffectKindEffectTint:
			return int64(3)
		case ViewportEffectKindEffectBlur:
			return int64(4)
		default:
			panic("non-exhaustive match")
		}
	}()
}

func effectTypeToInt(effect *ViewportEffect) int64 {
	return effectTypeToInt_impl(effect).(int64)
}

func effectToParams_impl(effect interface{}) interface{} {
	return func() interface{} {
		_scrutinee := effect
		_ = _scrutinee // suppress unused
		_adt := _scrutinee.(*ViewportEffect)
		switch _adt.Kind {
		case ViewportEffectKindEffectNone:
			return []interface{}{float64(0), float64(0)}
		case ViewportEffectKindEffectSRWarp:
			v := _adt.EffectSRWarp.Velocity
			_ = v // suppress unused
			return []interface{}{v, float64(0)}
		case ViewportEffectKindEffectGRLensing:
			m := _adt.EffectGRLensing.Mass
			_ = m // suppress unused
			d := _adt.EffectGRLensing.Distance
			_ = d // suppress unused
			return []interface{}{m, d}
		case ViewportEffectKindEffectTint:
			c := _adt.EffectTint.Rgba
			_ = c // suppress unused
			i := _adt.EffectTint.Intensity
			_ = i // suppress unused
			return func() interface{} {
				var tmp21 interface{} = IntToFloat(c)
				_ = tmp21 // suppress unused
				return []interface{}{tmp21, i}
			}()
		case ViewportEffectKindEffectBlur:
			r := _adt.EffectBlur.Radius
			_ = r // suppress unused
			return []interface{}{r, float64(0)}
		default:
			panic("non-exhaustive match")
		}
	}()
}

func effectToParams(effect *ViewportEffect) []float64 {
	return effectToParams_impl(effect).([]float64)
}

func firstEffect_impl(vp interface{}) interface{} {
	var tmp22 interface{} = FieldGet(vp, "effects")
	return func() interface{} {
		_scrutinee := tmp22
		_ = _scrutinee // suppress unused
		if ListLen(_scrutinee) == 0 {
			return NewViewportEffectEffectNone()
		} else if ListLen(_scrutinee) >= 1 {
			e := ListHead(_scrutinee)
			_ = e // suppress unused
			return e
		} else {
			panic("non-exhaustive match")
		}
	}()
}

func firstEffect(vp *ViewportDef) *ViewportEffect {
	return firstEffect_impl(vp).(*ViewportEffect)
}

func viewportToDrawCmd_impl(vp interface{}, z interface{}) interface{} {
	var shapeT interface{} = func() interface{} {
		var tmp32 interface{} = FieldGet(vp, "shape")
		_ = tmp32 // suppress unused
		return shapeTypeToInt_impl(tmp32)
	}()
	var shapeP interface{} = func() interface{} {
		var tmp31 interface{} = FieldGet(vp, "shape")
		_ = tmp31 // suppress unused
		return shapeToParams_impl(tmp31)
	}()
	var contentT interface{} = func() interface{} {
		var tmp30 interface{} = FieldGet(vp, "content")
		_ = tmp30 // suppress unused
		return contentTypeToInt_impl(tmp30)
	}()
	var contentP interface{} = func() interface{} {
		var tmp29 interface{} = FieldGet(vp, "content")
		_ = tmp29 // suppress unused
		return contentToParams_impl(tmp29)
	}()
	var eff interface{} = firstEffect_impl(vp)
	var effectT interface{} = effectTypeToInt_impl(eff)
	var effectP interface{} = effectToParams_impl(eff)
	var tmp23 interface{} = FieldGet(vp, "id")
	var tmp24 interface{} = FieldGet(vp, "layer")
	var tmp25 interface{} = FieldGet(vp, "edgeBlend")
	var tmp26 interface{} = FieldGet(vp, "opacity")
	var tmp27 interface{} = FieldGet(vp, "screenX")
	var tmp28 interface{} = FieldGet(vp, "screenY")
	return NewDrawCmdViewport(tmp23.(string), shapeT.(int64), shapeP.([]float64), contentT.(int64), contentP.([]float64), effectT.(int64), effectP.([]float64), tmp24.(int64), tmp25.(float64), tmp26.(float64), tmp27.(float64), tmp28.(float64), z.(int64))
}

func ViewportToDrawCmd(vp *ViewportDef, z int64) *DrawCmd {
	return viewportToDrawCmd_impl(vp, z).(*DrawCmd)
}
