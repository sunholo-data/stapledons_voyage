// Code generated by ailang. DO NOT EDIT.
package sim_gen

import (
	"math"
)

func filterStars_impl(predicate interface{}, stars interface{}) interface{} {
	return func() interface{} {
		_scrutinee := stars
		_ = _scrutinee // suppress unused
		if ListLen(_scrutinee) == 0 {
			return []interface{}{}
		} else if ListLen(_scrutinee) >= 1 {
			s := ListHead(_scrutinee)
			_ = s // suppress unused
			rest := ListTail(_scrutinee)
			_ = rest // suppress unused
			return func() interface{} {
				var tmp1 interface{} = CallFunc(predicate, s)
				_ = tmp1 // suppress unused
				return func() interface{} {
					if tmp1.(bool) {
						return func() interface{} {
							var tmp2 interface{} = filterStars_impl(predicate, rest)
							_ = tmp2 // suppress unused
							return Cons(s, tmp2)
						}()
					} else {
						return filterStars_impl(predicate, rest)
					}
				}()
			}()
		} else {
			panic("non-exhaustive match")
		}
	}()
}

func filterStars(predicate interface{}, stars []*Star) []*Star {
	return ConvertToStarSlice(filterStars_impl(predicate, stars))
}

func countStars_impl(stars interface{}) interface{} {
	return func() interface{} {
		_scrutinee := stars
		_ = _scrutinee // suppress unused
		if ListLen(_scrutinee) == 0 {
			return int64(0)
		} else if ListLen(_scrutinee) >= 1 {
			rest := ListTail(_scrutinee)
			_ = rest // suppress unused
			return func() interface{} {
				var tmp3 interface{} = countStars_impl(rest)
				_ = tmp3 // suppress unused
				return AddInt(int64(1), tmp3)
			}()
		} else {
			panic("non-exhaustive match")
		}
	}()
}

func countStars(stars []*Star) int64 {
	return countStars_impl(stars).(int64)
}

func distance_impl(a interface{}, b interface{}) interface{} {
	var dx interface{} = func() interface{} {
		var tmp13 interface{} = FieldGet(a, "x")
		_ = tmp13 // suppress unused
		var tmp14 interface{} = FieldGet(b, "x")
		_ = tmp14 // suppress unused
		return SubFloat(tmp13, tmp14)
	}()
	var dy interface{} = func() interface{} {
		var tmp11 interface{} = FieldGet(a, "y")
		_ = tmp11 // suppress unused
		var tmp12 interface{} = FieldGet(b, "y")
		_ = tmp12 // suppress unused
		return SubFloat(tmp11, tmp12)
	}()
	var dz interface{} = func() interface{} {
		var tmp9 interface{} = FieldGet(a, "z")
		_ = tmp9 // suppress unused
		var tmp10 interface{} = FieldGet(b, "z")
		_ = tmp10 // suppress unused
		return SubFloat(tmp9, tmp10)
	}()
	var tmp4 interface{} = MulFloat(dx, dx)
	var tmp5 interface{} = MulFloat(dy, dy)
	var tmp6 interface{} = AddFloat(tmp4, tmp5)
	var tmp7 interface{} = MulFloat(dz, dz)
	var tmp8 interface{} = AddFloat(tmp6, tmp7)
	return math.Sqrt(tmp8.(float64))
}

func Distance(a *Vec3, b *Vec3) float64 {
	return distance_impl(a, b).(float64)
}

func vec3Zero_impl(_unused0 interface{}) interface{} {
	return &Vec3{X: float64(0), Y: float64(0), Z: float64(0)}
}

func Vec3Zero() *Vec3 {
	return vec3Zero_impl(struct{}{}).(*Vec3)
}

func makeVec3_impl(x interface{}, y interface{}, z interface{}) interface{} {
	return &Vec3{X: x.(float64), Y: y.(float64), Z: z.(float64)}
}

func MakeVec3(x float64, y float64, z float64) *Vec3 {
	return makeVec3_impl(x, y, z).(*Vec3)
}

func emptyCatalog_impl(_unused0 interface{}) interface{} {
	var tmp15 interface{} = []interface{}{}
	return &StarCatalog{Stars: ConvertToStarSlice(tmp15), SolIndex: int64(0)}
}

func EmptyCatalog() *StarCatalog {
	return emptyCatalog_impl(struct{}{}).(*StarCatalog)
}

func addStar_impl(cat interface{}, star interface{}) interface{} {
	var tmp16 interface{} = FieldGet(cat, "stars")
	var tmp17 interface{} = Cons(star, tmp16)
	var tmp18 interface{} = FieldGet(cat, "solIndex")
	return &StarCatalog{Stars: ConvertToStarSlice(tmp17), SolIndex: tmp18.(int64)}
}

func AddStar(cat *StarCatalog, star *Star) *StarCatalog {
	return addStar_impl(cat, star).(*StarCatalog)
}

func starCount_impl(cat interface{}) interface{} {
	var tmp19 interface{} = FieldGet(cat, "stars")
	return countStars_impl(tmp19)
}

func StarCount(cat *StarCatalog) int64 {
	return starCount_impl(cat).(int64)
}

func withinRadius_impl(center interface{}, radius interface{}, star interface{}) interface{} {
	var tmp20 interface{} = FieldGet(star, "pos")
	var tmp21 interface{} = distance_impl(tmp20, center)
	return LeFloat(tmp21, radius)
}

func withinRadius(center *Vec3, radius float64, star *Star) bool {
	return withinRadius_impl(center, radius, star).(bool)
}

func starsWithinRadius_impl(cat interface{}, center interface{}, radius interface{}) interface{} {
	var tmp22 interface{} = FieldGet(cat, "stars")
	return filterStars_impl(func(s interface{}) interface{} {
		return withinRadius_impl(center, radius, s)
	}, tmp22)
}

func StarsWithinRadius(cat *StarCatalog, center *Vec3, radius float64) []*Star {
	return ConvertToStarSlice(starsWithinRadius_impl(cat, center, radius))
}

func minByDistanceHelper_impl(pos interface{}, best interface{}, rest interface{}) interface{} {
	return func() interface{} {
		_scrutinee := rest
		_ = _scrutinee // suppress unused
		if ListLen(_scrutinee) == 0 {
			return best
		} else if ListLen(_scrutinee) >= 1 {
			s := ListHead(_scrutinee)
			_ = s // suppress unused
			remaining := ListTail(_scrutinee)
			_ = remaining // suppress unused
			return func() interface{} {
				var bestDist interface{} = func() interface{} {
					var tmp25 interface{} = FieldGet(best, "pos")
					_ = tmp25 // suppress unused
					return distance_impl(tmp25, pos)
				}()
				_ = bestDist // suppress unused
				var sDist interface{} = func() interface{} {
					var tmp24 interface{} = FieldGet(s, "pos")
					_ = tmp24 // suppress unused
					return distance_impl(tmp24, pos)
				}()
				_ = sDist // suppress unused
				var tmp23 interface{} = LtInt(sDist, bestDist)
				_ = tmp23 // suppress unused
				return func() interface{} {
					if tmp23.(bool) {
						return minByDistanceHelper_impl(pos, s, remaining)
					} else {
						return minByDistanceHelper_impl(pos, best, remaining)
					}
				}()
			}()
		} else {
			panic("non-exhaustive match")
		}
	}()
}

func minByDistanceHelper(pos *Vec3, best *Star, rest []*Star) *Star {
	return minByDistanceHelper_impl(pos, best, rest).(*Star)
}

func nearestStar_impl(cat interface{}, pos interface{}) interface{} {
	var tmp26 interface{} = FieldGet(cat, "stars")
	return func() interface{} {
		_scrutinee := tmp26
		_ = _scrutinee // suppress unused
		if ListLen(_scrutinee) == 0 {
			return func() interface{} {
				var tmp27 interface{} = SubInt(int64(0), int64(1))
				_ = tmp27 // suppress unused
				var tmp28 interface{} = vec3Zero_impl(struct{}{})
				_ = tmp28 // suppress unused
				return &Star{Id: tmp27.(int64), Name: "NONE", Pos: tmp28.(*Vec3), Spectral: NewSpectralTypeM(), Luminosity: float64(0), HasHZPlanet: false}
			}()
		} else if ListLen(_scrutinee) >= 1 {
			first := ListHead(_scrutinee)
			_ = first // suppress unused
			rest := ListTail(_scrutinee)
			_ = rest // suppress unused
			return minByDistanceHelper_impl(pos, first, rest)
		} else {
			panic("non-exhaustive match")
		}
	}()
}

func NearestStar(cat *StarCatalog, pos *Vec3) *Star {
	return nearestStar_impl(cat, pos).(*Star)
}

func spectralFromRoll_impl(roll interface{}) interface{} {
	if LtFloat(roll, float64(0.76)).(bool) {
		return NewSpectralTypeM()
	} else if LtFloat(roll, float64(0.88)).(bool) {
		return NewSpectralTypeK()
	} else if LtFloat(roll, float64(0.955)).(bool) {
		return NewSpectralTypeG()
	} else if LtFloat(roll, float64(0.985)).(bool) {
		return NewSpectralTypeF()
	} else if LtFloat(roll, float64(0.991)).(bool) {
		return NewSpectralTypeA()
	} else if LtFloat(roll, float64(0.99913)).(bool) {
		return NewSpectralTypeB()
	} else {
		return NewSpectralTypeO()
	}
}

func SpectralFromRoll(roll float64) *SpectralType {
	return spectralFromRoll_impl(roll).(*SpectralType)
}

func luminosityForSpectral_impl(spec interface{}) interface{} {
	return func() interface{} {
		_scrutinee := spec
		_ = _scrutinee // suppress unused
		_adt := _scrutinee.(*SpectralType)
		switch _adt.Kind {
		case SpectralTypeKindO:
			return float64(30000)
		case SpectralTypeKindB:
			return float64(1000)
		case SpectralTypeKindA:
			return float64(20)
		case SpectralTypeKindF:
			return float64(3)
		case SpectralTypeKindG:
			return float64(1)
		case SpectralTypeKindK:
			return float64(0.4)
		case SpectralTypeKindM:
			return float64(0.04)
		default:
			panic("non-exhaustive match")
		}
	}()
}

func LuminosityForSpectral(spec *SpectralType) float64 {
	return luminosityForSpectral_impl(spec).(float64)
}

func spectralColor_impl(spec interface{}) interface{} {
	return func() interface{} {
		_scrutinee := spec
		_ = _scrutinee // suppress unused
		_adt := _scrutinee.(*SpectralType)
		switch _adt.Kind {
		case SpectralTypeKindO:
			return int64(2611347455)
		case SpectralTypeKindB:
			return int64(2864414719)
		case SpectralTypeKindA:
			return int64(3403726847)
		case SpectralTypeKindF:
			return int64(4177461247)
		case SpectralTypeKindG:
			return int64(4294311679)
		case SpectralTypeKindK:
			return int64(4292124159)
		case SpectralTypeKindM:
			return int64(4291716095)
		default:
			panic("non-exhaustive match")
		}
	}()
}

func SpectralColor(spec *SpectralType) int64 {
	return spectralColor_impl(spec).(int64)
}

func makeStar_impl(id interface{}, name interface{}, x interface{}, y interface{}, z interface{}, spec interface{}, hasHZ interface{}) interface{} {
	var tmp35 interface{} = makeVec3_impl(x, y, z)
	var tmp36 interface{} = luminosityForSpectral_impl(spec)
	return &Star{Id: id.(int64), Name: name.(string), Pos: tmp35.(*Vec3), Spectral: spec.(*SpectralType), Luminosity: tmp36.(float64), HasHZPlanet: hasHZ.(bool)}
}

func MakeStar(id int64, name string, x float64, y float64, z float64, spec *SpectralType, hasHZ bool) *Star {
	return makeStar_impl(id, name, x, y, z, spec, hasHZ).(*Star)
}

func makeSol_impl(_unused0 interface{}) interface{} {
	return makeStar_impl(int64(0), "Sol", float64(0), float64(0), float64(0), NewSpectralTypeG(), true)
}

func MakeSol() *Star {
	return makeSol_impl(struct{}{}).(*Star)
}

func initLocalCatalog_impl(_unused0 interface{}) interface{} {
	var stars interface{} = func() interface{} {
		var tmp37 interface{} = makeSol_impl(struct{}{})
		_ = tmp37 // suppress unused
		var tmp38 interface{} = NegFloat(float64(1.55))
		_ = tmp38 // suppress unused
		var tmp39 interface{} = NegFloat(float64(1.32))
		_ = tmp39 // suppress unused
		var tmp40 interface{} = NegFloat(float64(3.77))
		_ = tmp40 // suppress unused
		var tmp41 interface{} = makeStar_impl(int64(1), "Proxima Centauri", tmp38, tmp39, tmp40, NewSpectralTypeM(), true)
		_ = tmp41 // suppress unused
		var tmp42 interface{} = NegFloat(float64(1.64))
		_ = tmp42 // suppress unused
		var tmp43 interface{} = NegFloat(float64(1.36))
		_ = tmp43 // suppress unused
		var tmp44 interface{} = NegFloat(float64(3.84))
		_ = tmp44 // suppress unused
		var tmp45 interface{} = makeStar_impl(int64(2), "Alpha Centauri A", tmp42, tmp43, tmp44, NewSpectralTypeG(), true)
		_ = tmp45 // suppress unused
		var tmp46 interface{} = NegFloat(float64(1.64))
		_ = tmp46 // suppress unused
		var tmp47 interface{} = NegFloat(float64(1.36))
		_ = tmp47 // suppress unused
		var tmp48 interface{} = NegFloat(float64(3.84))
		_ = tmp48 // suppress unused
		var tmp49 interface{} = makeStar_impl(int64(3), "Alpha Centauri B", tmp46, tmp47, tmp48, NewSpectralTypeK(), true)
		_ = tmp49 // suppress unused
		var tmp50 interface{} = NegFloat(float64(0.06))
		_ = tmp50 // suppress unused
		var tmp51 interface{} = makeStar_impl(int64(4), "Barnard's Star", tmp50, float64(5.94), float64(0.49), NewSpectralTypeM(), false)
		_ = tmp51 // suppress unused
		var tmp52 interface{} = NegFloat(float64(7.43))
		_ = tmp52 // suppress unused
		var tmp53 interface{} = NegFloat(float64(0.66))
		_ = tmp53 // suppress unused
		var tmp54 interface{} = makeStar_impl(int64(5), "Wolf 359", tmp52, float64(2.11), tmp53, NewSpectralTypeM(), false)
		_ = tmp54 // suppress unused
		var tmp55 interface{} = NegFloat(float64(6.52))
		_ = tmp55 // suppress unused
		var tmp56 interface{} = NegFloat(float64(1.9))
		_ = tmp56 // suppress unused
		var tmp57 interface{} = makeStar_impl(int64(6), "Lalande 21185", tmp55, tmp56, float64(4.88), NewSpectralTypeM(), true)
		_ = tmp57 // suppress unused
		var tmp58 interface{} = NegFloat(float64(1.61))
		_ = tmp58 // suppress unused
		var tmp59 interface{} = NegFloat(float64(2.47))
		_ = tmp59 // suppress unused
		var tmp60 interface{} = makeStar_impl(int64(7), "Sirius A", tmp58, float64(8.06), tmp59, NewSpectralTypeA(), false)
		_ = tmp60 // suppress unused
		var tmp61 interface{} = NegFloat(float64(1.61))
		_ = tmp61 // suppress unused
		var tmp62 interface{} = NegFloat(float64(2.47))
		_ = tmp62 // suppress unused
		var tmp63 interface{} = makeStar_impl(int64(8), "Sirius B", tmp61, float64(8.06), tmp62, NewSpectralTypeA(), false)
		_ = tmp63 // suppress unused
		var tmp64 interface{} = NegFloat(float64(0.8))
		_ = tmp64 // suppress unused
		var tmp65 interface{} = makeStar_impl(int64(9), "Luyten 726-8 A", float64(8.56), tmp64, float64(1.28), NewSpectralTypeM(), false)
		_ = tmp65 // suppress unused
		var tmp66 interface{} = NegFloat(float64(8.87))
		_ = tmp66 // suppress unused
		var tmp67 interface{} = NegFloat(float64(3.32))
		_ = tmp67 // suppress unused
		var tmp68 interface{} = makeStar_impl(int64(10), "Ross 154", float64(1.91), tmp66, tmp67, NewSpectralTypeM(), false)
		_ = tmp68 // suppress unused
		var tmp69 interface{} = NegFloat(float64(0.59))
		_ = tmp69 // suppress unused
		var tmp70 interface{} = makeStar_impl(int64(11), "Ross 248", float64(7.38), tmp69, float64(7.19), NewSpectralTypeM(), false)
		_ = tmp70 // suppress unused
		var tmp71 interface{} = NegFloat(float64(6.22))
		_ = tmp71 // suppress unused
		var tmp72 interface{} = NegFloat(float64(1.73))
		_ = tmp72 // suppress unused
		var tmp73 interface{} = makeStar_impl(int64(12), "Epsilon Eridani", tmp71, float64(8.31), tmp72, NewSpectralTypeK(), true)
		_ = tmp73 // suppress unused
		var tmp74 interface{} = NegFloat(float64(8.46))
		_ = tmp74 // suppress unused
		var tmp75 interface{} = NegFloat(float64(2))
		_ = tmp75 // suppress unused
		var tmp76 interface{} = NegFloat(float64(6.3))
		_ = tmp76 // suppress unused
		var tmp77 interface{} = makeStar_impl(int64(13), "Lacaille 9352", tmp74, tmp75, tmp76, NewSpectralTypeM(), false)
		_ = tmp77 // suppress unused
		var tmp78 interface{} = NegFloat(float64(10.9))
		_ = tmp78 // suppress unused
		var tmp79 interface{} = NegFloat(float64(1.35))
		_ = tmp79 // suppress unused
		var tmp80 interface{} = makeStar_impl(int64(14), "Ross 128", tmp78, float64(0.58), tmp79, NewSpectralTypeM(), true)
		_ = tmp80 // suppress unused
		var tmp81 interface{} = NegFloat(float64(2.97))
		_ = tmp81 // suppress unused
		var tmp82 interface{} = makeStar_impl(int64(15), "EZ Aquarii A", float64(10.19), float64(3.79), tmp81, NewSpectralTypeM(), false)
		_ = tmp82 // suppress unused
		var tmp83 interface{} = NegFloat(float64(4.77))
		_ = tmp83 // suppress unused
		var tmp84 interface{} = NegFloat(float64(0.39))
		_ = tmp84 // suppress unused
		var tmp85 interface{} = makeStar_impl(int64(16), "Procyon A", tmp83, float64(10.31), tmp84, NewSpectralTypeF(), false)
		_ = tmp85 // suppress unused
		var tmp86 interface{} = NegFloat(float64(6.06))
		_ = tmp86 // suppress unused
		var tmp87 interface{} = makeStar_impl(int64(17), "61 Cygni A", float64(6.4), tmp86, float64(7.14), NewSpectralTypeK(), false)
		_ = tmp87 // suppress unused
		var tmp88 interface{} = NegFloat(float64(6.06))
		_ = tmp88 // suppress unused
		var tmp89 interface{} = makeStar_impl(int64(18), "61 Cygni B", float64(6.4), tmp88, float64(7.14), NewSpectralTypeK(), false)
		_ = tmp89 // suppress unused
		var tmp90 interface{} = NegFloat(float64(7.59))
		_ = tmp90 // suppress unused
		var tmp91 interface{} = makeStar_impl(int64(19), "Struve 2398 A", float64(7.02), tmp90, float64(4.73), NewSpectralTypeM(), false)
		_ = tmp91 // suppress unused
		var tmp92 interface{} = NegFloat(float64(10.84))
		_ = tmp92 // suppress unused
		var tmp93 interface{} = makeStar_impl(int64(20), "Groombridge 34 A", float64(0.05), float64(4.18), tmp92, NewSpectralTypeM(), false)
		_ = tmp93 // suppress unused
		return []interface{}{tmp37, tmp41, tmp45, tmp49, tmp51, tmp54, tmp57, tmp60, tmp63, tmp65, tmp68, tmp70, tmp73, tmp77, tmp80, tmp82, tmp85, tmp87, tmp89, tmp91, tmp93}
	}()
	return &StarCatalog{Stars: ConvertToStarSlice(stars), SolIndex: int64(0)}
}

func InitLocalCatalog() *StarCatalog {
	return initLocalCatalog_impl(struct{}{}).(*StarCatalog)
}

func solPosition_impl(_unused0 interface{}) interface{} {
	return vec3Zero_impl(struct{}{})
}

func SolPosition() *Vec3 {
	return solPosition_impl(struct{}{}).(*Vec3)
}
