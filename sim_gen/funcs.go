// Code generated by ailang. DO NOT EDIT.
package sim_gen

func generate(n interface{}, f interface{}) interface{} {
	return func() interface{} {
		_scrutinee := n
		_ = _scrutinee // suppress unused
		switch _scrutinee {
		case int64(0):
			return []interface{}{}
		default:
			return func() interface{} {
				tmp1 := SubInt(n, 1)
				_ = tmp1 // suppress unused
				return func() interface{} {
					tmp2 := CallFunc(f, tmp1)
					_ = tmp2 // suppress unused
					return func() interface{} {
						tmp3 := SubInt(n, 1)
						_ = tmp3 // suppress unused
						return func() interface{} {
							tmp4 := generate(tmp3, f)
							_ = tmp4 // suppress unused
							return Cons(tmp2, tmp4)
						}()
					}()
				}()
			}()
		}
	}()
}

func tilesToDraw(tiles interface{}, width interface{}, idx interface{}) interface{} {
	return func() interface{} {
		_scrutinee := tiles
		_ = _scrutinee // suppress unused
		if ListLen(_scrutinee) == 0 {
			return []interface{}{}
		} else if ListLen(_scrutinee) >= 1 {
			t := ListHead(_scrutinee)
			_ = t // suppress unused
			rest := ListTail(_scrutinee)
			_ = rest // suppress unused
			return func() interface{} {
				x := ModInt(idx, width)
				_ = x // suppress unused
				return func() interface{} {
					y := DivInt(idx, width)
					_ = y // suppress unused
					return func() interface{} {
						cmd := func() interface{} {
							tmp7 := MulInt(x, 8)
							_ = tmp7 // suppress unused
							return func() interface{} {
								tmp8 := IntToFloat(tmp7)
								_ = tmp8 // suppress unused
								return func() interface{} {
									tmp9 := MulInt(y, 8)
									_ = tmp9 // suppress unused
									return func() interface{} {
										tmp10 := IntToFloat(tmp9)
										_ = tmp10 // suppress unused
										return func() interface{} {
											tmp11 := t.(map[string]interface{})["biome"]
											_ = tmp11 // suppress unused
											return NewDrawCmdRect(tmp8.(float64), tmp10.(float64), float64(8), float64(8), tmp11.(int64), int64(0))
										}()
									}()
								}()
							}()
						}()
						_ = cmd // suppress unused
						return func() interface{} {
							tmp5 := AddInt(idx, 1)
							_ = tmp5 // suppress unused
							return func() interface{} {
								tmp6 := tilesToDraw(rest, width, tmp5)
								_ = tmp6 // suppress unused
								return Cons(cmd, tmp6)
							}()
						}()
					}()
				}()
			}()
		} else {
			panic("non-exhaustive match")
		}
	}()
}

func npcsToDraw(npcs interface{}) interface{} {
	return func() interface{} {
		_scrutinee := npcs
		_ = _scrutinee // suppress unused
		if ListLen(_scrutinee) == 0 {
			return []interface{}{}
		} else if ListLen(_scrutinee) >= 1 {
			npc := ListHead(_scrutinee)
			_ = npc // suppress unused
			rest := ListTail(_scrutinee)
			_ = rest // suppress unused
			return func() interface{} {
				cmd := func() interface{} {
					tmp13 := npc.(map[string]interface{})["pos"]
					_ = tmp13 // suppress unused
					return func() interface{} {
						tmp14 := tmp13.(map[string]interface{})["x"]
						_ = tmp14 // suppress unused
						return func() interface{} {
							tmp15 := MulInt(tmp14, 8)
							_ = tmp15 // suppress unused
							return func() interface{} {
								tmp16 := IntToFloat(tmp15)
								_ = tmp16 // suppress unused
								return func() interface{} {
									tmp17 := npc.(map[string]interface{})["pos"]
									_ = tmp17 // suppress unused
									return func() interface{} {
										tmp18 := tmp17.(map[string]interface{})["y"]
										_ = tmp18 // suppress unused
										return func() interface{} {
											tmp19 := MulInt(tmp18, 8)
											_ = tmp19 // suppress unused
											return func() interface{} {
												tmp20 := IntToFloat(tmp19)
												_ = tmp20 // suppress unused
												return func() interface{} {
													tmp21 := npc.(map[string]interface{})["id"]
													_ = tmp21 // suppress unused
													return func() interface{} {
														tmp22 := AddInt(10, tmp21)
														_ = tmp22 // suppress unused
														return NewDrawCmdRect(tmp16.(float64), tmp20.(float64), float64(8), float64(8), tmp22.(int64), int64(2))
													}()
												}()
											}()
										}()
									}()
								}()
							}()
						}()
					}()
				}()
				_ = cmd // suppress unused
				return func() interface{} {
					tmp12 := npcsToDraw(rest)
					_ = tmp12 // suppress unused
					return Cons(cmd, tmp12)
				}()
			}()
		} else {
			panic("non-exhaustive match")
		}
	}()
}

func selectionToDraw(sel interface{}) interface{} {
	return func() interface{} {
		_scrutinee := sel
		_ = _scrutinee // suppress unused
		_adt := _scrutinee.(*Selection)
		switch _adt.Kind {
		default:
			selectionNone := _adt
			_ = selectionNone // suppress unused
			return []interface{}{}
		case SelectionKindTile:
			x := _adt.SelectionTile.Value0
			_ = x // suppress unused
			y := _adt.SelectionTile.Value1
			_ = y // suppress unused
			return func() interface{} {
				tmp23 := MulInt(x, 8)
				_ = tmp23 // suppress unused
				return func() interface{} {
					tmp24 := IntToFloat(tmp23)
					_ = tmp24 // suppress unused
					return func() interface{} {
						tmp25 := MulInt(y, 8)
						_ = tmp25 // suppress unused
						return func() interface{} {
							tmp26 := IntToFloat(tmp25)
							_ = tmp26 // suppress unused
							return func() interface{} {
								tmp27 := NewDrawCmdRect(tmp24.(float64), tmp26.(float64), float64(8), float64(8), int64(4), int64(3))
								_ = tmp27 // suppress unused
								return []interface{}{tmp27}
							}()
						}()
					}()
				}()
			}()
		}
	}()
}

func concatDrawCmds(a interface{}, b interface{}) interface{} {
	return func() interface{} {
		_scrutinee := a
		_ = _scrutinee // suppress unused
		if ListLen(_scrutinee) == 0 {
			return b
		} else if ListLen(_scrutinee) >= 1 {
			x := ListHead(_scrutinee)
			_ = x // suppress unused
			rest := ListTail(_scrutinee)
			_ = rest // suppress unused
			return func() interface{} {
				tmp28 := concatDrawCmds(rest, b)
				_ = tmp28 // suppress unused
				return Cons(x, tmp28)
			}()
		} else {
			panic("non-exhaustive match")
		}
	}()
}

func processSelection(input interface{}, world interface{}) interface{} {
	return func() interface{} {
		tmp29 := input.(map[string]interface{})["clickedThisFrame"]
		_ = tmp29 // suppress unused
		return func() interface{} {
			if tmp29.(bool) {
				return func() interface{} {
					tileX := func() interface{} {
						tmp43 := input.(map[string]interface{})["worldMouseX"]
						_ = tmp43 // suppress unused
						return func() interface{} {
							tmp44 := DivInt(tmp43, 8)
							_ = tmp44 // suppress unused
							return FloatToInt(tmp44)
						}()
					}()
					_ = tileX // suppress unused
					return func() interface{} {
						tileY := func() interface{} {
							tmp41 := input.(map[string]interface{})["worldMouseY"]
							_ = tmp41 // suppress unused
							return func() interface{} {
								tmp42 := DivInt(tmp41, 8)
								_ = tmp42 // suppress unused
								return FloatToInt(tmp42)
							}()
						}()
						_ = tileY // suppress unused
						return func() interface{} {
							tmp30 := GeInt(tileX, 0)
							_ = tmp30 // suppress unused
							return func() interface{} {
								tmp31 := world.(map[string]interface{})["planet"]
								_ = tmp31 // suppress unused
								return func() interface{} {
									tmp32 := tmp31.(map[string]interface{})["width"]
									_ = tmp32 // suppress unused
									return func() interface{} {
										tmp33 := LtInt(tileX, tmp32)
										_ = tmp33 // suppress unused
										return func() interface{} {
											tmp34 := func() interface{} {
												if tmp30.(bool) {
													return tmp33
												}
												return false
											}()
											_ = tmp34 // suppress unused
											return func() interface{} {
												tmp35 := GeInt(tileY, 0)
												_ = tmp35 // suppress unused
												return func() interface{} {
													tmp36 := func() interface{} {
														if tmp34.(bool) {
															return tmp35
														}
														return false
													}()
													_ = tmp36 // suppress unused
													return func() interface{} {
														tmp37 := world.(map[string]interface{})["planet"]
														_ = tmp37 // suppress unused
														return func() interface{} {
															tmp38 := tmp37.(map[string]interface{})["height"]
															_ = tmp38 // suppress unused
															return func() interface{} {
																tmp39 := LtInt(tileY, tmp38)
																_ = tmp39 // suppress unused
																return func() interface{} {
																	tmp40 := func() interface{} {
																		if tmp36.(bool) {
																			return tmp39
																		}
																		return false
																	}()
																	_ = tmp40 // suppress unused
																	return func() interface{} {
																		if tmp40.(bool) {
																			return NewSelectionTile(tileX.(int64), tileY.(int64))
																		}
																		return NewSelectionNone()
																	}()
																}()
															}()
														}()
													}()
												}()
											}()
										}()
									}()
								}()
							}()
						}()
					}()
				}()
			}
			return world.(map[string]interface{})["selection"]
		}()
	}()
}

func InitWorld(seed interface{}) interface{} {
	return func() interface{} {
		w := 8
		_ = w // suppress unused
		return func() interface{} {
			h := 8
			_ = h // suppress unused
			return func() interface{} {
				tiles := func() interface{} {
					tmp57 := MulInt(w, h)
					_ = tmp57 // suppress unused
					return generate(tmp57, func(i interface{}) interface{} {
						return func() interface{} {
							tmp58 := ModInt(i, 4)
							_ = tmp58 // suppress unused
							return map[string]interface{}{"biome": tmp58}
						}()
					})
				}()
				_ = tiles // suppress unused
				return func() interface{} {
					patrolPath := []interface{}{NewDirectionEast(), NewDirectionEast(), NewDirectionSouth(), NewDirectionSouth(), NewDirectionWest(), NewDirectionWest(), NewDirectionNorth(), NewDirectionNorth()}
					_ = patrolPath // suppress unused
					return func() interface{} {
						testNpcs := func() interface{} {
							tmp46 := map[string]interface{}{"x": 2, "y": 2}
							_ = tmp46 // suppress unused
							return func() interface{} {
								tmp47 := NewMovementPatternPatternRandomWalk(int64(30))
								_ = tmp47 // suppress unused
								return func() interface{} {
									tmp48 := map[string]interface{}{"id": 1, "pos": tmp46, "pattern": tmp47, "moveCounter": 30, "patrolIndex": 0}
									_ = tmp48 // suppress unused
									return func() interface{} {
										tmp49 := map[string]interface{}{"x": 5, "y": 3}
										_ = tmp49 // suppress unused
										return func() interface{} {
											tmp50 := NewMovementPatternPatternRandomWalk(int64(45))
											_ = tmp50 // suppress unused
											return func() interface{} {
												tmp51 := map[string]interface{}{"moveCounter": 45, "patrolIndex": 0, "id": 2, "pos": tmp49, "pattern": tmp50}
												_ = tmp51 // suppress unused
												return func() interface{} {
													tmp52 := map[string]interface{}{"x": 4, "y": 4}
													_ = tmp52 // suppress unused
													return func() interface{} {
														tmp53 := map[string]interface{}{"pos": tmp52, "pattern": NewMovementPatternPatternStatic(), "moveCounter": 0, "patrolIndex": 0, "id": 3}
														_ = tmp53 // suppress unused
														return func() interface{} {
															tmp54 := map[string]interface{}{"x": 1, "y": 1}
															_ = tmp54 // suppress unused
															return func() interface{} {
																tmp55 := NewMovementPatternPatternPatrol(patrolPath)
																_ = tmp55 // suppress unused
																return func() interface{} {
																	tmp56 := map[string]interface{}{"moveCounter": 0, "patrolIndex": 0, "id": 4, "pos": tmp54, "pattern": tmp55}
																	_ = tmp56 // suppress unused
																	return []interface{}{tmp48, tmp51, tmp53, tmp56}
																}()
															}()
														}()
													}()
												}()
											}()
										}()
									}()
								}()
							}()
						}()
						_ = testNpcs // suppress unused
						return func() interface{} {
							tmp45 := map[string]interface{}{"width": w, "height": h, "tiles": tiles}
							_ = tmp45 // suppress unused
							return map[string]interface{}{"planet": tmp45, "npcs": testNpcs, "selection": NewSelectionNone(), "tick": 0}
						}()
					}()
				}()
			}()
		}()
	}()
}

func Step(world interface{}, input interface{}) interface{} {
	return func() interface{} {
		block0 := func() interface{} {
			tmp72 := world.(map[string]interface{})["tick"]
			_ = tmp72 // suppress unused
			return func() interface{} {
				tmp73 := Show(tmp72)
				_ = tmp73 // suppress unused
				return func() interface{} {
					tmp74 := ConcatString("tick ", tmp73)
					_ = tmp74 // suppress unused
					return Log(tmp74)
				}()
			}()
		}()
		_ = block0 // suppress unused
		return func() interface{} {
			newSelection := processSelection(input, world)
			_ = newSelection // suppress unused
			return func() interface{} {
				newTick := func() interface{} {
					tmp71 := world.(map[string]interface{})["tick"]
					_ = tmp71 // suppress unused
					return AddInt(tmp71, 1)
				}()
				_ = newTick // suppress unused
				return func() interface{} {
					updatedNpcs := func() interface{} {
						tmp66 := world.(map[string]interface{})["npcs"]
						_ = tmp66 // suppress unused
						return func() interface{} {
							tmp67 := world.(map[string]interface{})["planet"]
							_ = tmp67 // suppress unused
							return func() interface{} {
								tmp68 := tmp67.(map[string]interface{})["width"]
								_ = tmp68 // suppress unused
								return func() interface{} {
									tmp69 := world.(map[string]interface{})["planet"]
									_ = tmp69 // suppress unused
									return func() interface{} {
										tmp70 := tmp69.(map[string]interface{})["height"]
										_ = tmp70 // suppress unused
										return UpdateAllNPCs(tmp66, tmp68, tmp70)
									}()
								}()
							}()
						}()
					}()
					_ = updatedNpcs // suppress unused
					return func() interface{} {
						newWorld := RecordUpdate(world, map[string]interface{}{"tick": newTick, "npcs": updatedNpcs, "selection": newSelection})
						_ = newWorld // suppress unused
						return func() interface{} {
							tileCmds := func() interface{} {
								tmp62 := world.(map[string]interface{})["planet"]
								_ = tmp62 // suppress unused
								return func() interface{} {
									tmp63 := tmp62.(map[string]interface{})["tiles"]
									_ = tmp63 // suppress unused
									return func() interface{} {
										tmp64 := world.(map[string]interface{})["planet"]
										_ = tmp64 // suppress unused
										return func() interface{} {
											tmp65 := tmp64.(map[string]interface{})["width"]
											_ = tmp65 // suppress unused
											return tilesToDraw(tmp63, tmp65, 0)
										}()
									}()
								}()
							}()
							_ = tileCmds // suppress unused
							return func() interface{} {
								npcCmds := npcsToDraw(updatedNpcs)
								_ = npcCmds // suppress unused
								return func() interface{} {
									selCmds := selectionToDraw(newSelection)
									_ = selCmds // suppress unused
									return func() interface{} {
										drawCmds := func() interface{} {
											tmp61 := concatDrawCmds(tileCmds, npcCmds)
											_ = tmp61 // suppress unused
											return concatDrawCmds(tmp61, selCmds)
										}()
										_ = drawCmds // suppress unused
										return func() interface{} {
											cam := map[string]interface{}{"zoom": 1, "x": 0, "y": 0}
											_ = cam // suppress unused
											return func() interface{} {
												output := func() interface{} {
													tmp59 := []interface{}{}
													_ = tmp59 // suppress unused
													return func() interface{} {
														tmp60 := []interface{}{}
														_ = tmp60 // suppress unused
														return map[string]interface{}{"draw": drawCmds, "sounds": tmp59, "debug": tmp60, "camera": cam}
													}()
												}()
												_ = output // suppress unused
												return []interface{}{newWorld, output}
											}()
										}()
									}()
								}()
							}()
						}()
					}()
				}()
			}()
		}()
	}()
}


func IsInBounds(x interface{}, y interface{}, width interface{}, height interface{}) interface{} {
	return func() interface{} {
		tmp1 := GeInt(x, 0)
		_ = tmp1 // suppress unused
		return func() interface{} {
			tmp2 := LtInt(x, width)
			_ = tmp2 // suppress unused
			return func() interface{} {
				tmp3 := func() interface{} {
					if tmp1.(bool) {
						return tmp2
					}
					return false
				}()
				_ = tmp3 // suppress unused
				return func() interface{} {
					tmp4 := GeInt(y, 0)
					_ = tmp4 // suppress unused
					return func() interface{} {
						tmp5 := func() interface{} {
							if tmp3.(bool) {
								return tmp4
							}
							return false
						}()
						_ = tmp5 // suppress unused
						return func() interface{} {
							tmp6 := LtInt(y, height)
							_ = tmp6 // suppress unused
							return func() interface{} {
								if tmp5.(bool) {
									return tmp6
								}
								return false
							}()
						}()
					}()
				}()
			}()
		}()
	}()
}

func directionDx(dir interface{}) interface{} {
	return func() interface{} {
		_scrutinee := dir
		_ = _scrutinee // suppress unused
		_adt := _scrutinee.(*Direction)
		switch _adt.Kind {
		case DirectionKindNorth:
			return 0
		case DirectionKindSouth:
			return 0
		case DirectionKindEast:
			return 1
		case DirectionKindWest:
			return NegInt(1)
		default:
			panic("non-exhaustive match")
		}
	}()
}

func directionDy(dir interface{}) interface{} {
	return func() interface{} {
		_scrutinee := dir
		_ = _scrutinee // suppress unused
		_adt := _scrutinee.(*Direction)
		switch _adt.Kind {
		case DirectionKindNorth:
			return NegInt(1)
		case DirectionKindSouth:
			return 1
		case DirectionKindEast:
			return 0
		case DirectionKindWest:
			return 0
		default:
			panic("non-exhaustive match")
		}
	}()
}

func indexToDirection(idx interface{}) interface{} {
	return func() interface{} {
		tmp7 := ModInt(idx, 4)
		_ = tmp7 // suppress unused
		return func() interface{} {
			_scrutinee := tmp7
			_ = _scrutinee // suppress unused
			switch _scrutinee {
			case int64(0):
				return NewDirectionNorth()
			case int64(1):
				return NewDirectionSouth()
			case int64(2):
				return NewDirectionEast()
			default:
				return NewDirectionWest()
			}
		}()
	}()
}

func pathLength(path interface{}) interface{} {
	return func() interface{} {
		_scrutinee := path
		_ = _scrutinee // suppress unused
		if ListLen(_scrutinee) == 0 {
			return 0
		} else if ListLen(_scrutinee) >= 1 {
			rest := ListTail(_scrutinee)
			_ = rest // suppress unused
			return func() interface{} {
				tmp8 := pathLength(rest)
				_ = tmp8 // suppress unused
				return AddInt(1, tmp8)
			}()
		} else {
			panic("non-exhaustive match")
		}
	}()
}

func pathGet(path interface{}, idx interface{}) interface{} {
	return func() interface{} {
		_scrutinee := path
		_ = _scrutinee // suppress unused
		if ListLen(_scrutinee) == 0 {
			return NewDirectionNorth()
		} else if ListLen(_scrutinee) >= 1 {
			dir := ListHead(_scrutinee)
			_ = dir // suppress unused
			rest := ListTail(_scrutinee)
			_ = rest // suppress unused
			return func() interface{} {
				tmp9 := LeInt(idx, 0)
				_ = tmp9 // suppress unused
				return func() interface{} {
					if tmp9.(bool) {
						return dir
					}
					return func() interface{} {
						tmp10 := SubInt(idx, 1)
						_ = tmp10 // suppress unused
						return pathGet(rest, tmp10)
					}()
				}()
			}()
		} else {
			panic("non-exhaustive match")
		}
	}()
}

func npcWithPos(npc interface{}, newX interface{}, newY interface{}) interface{} {
	return func() interface{} {
		tmp11 := map[string]interface{}{"x": newX, "y": newY}
		_ = tmp11 // suppress unused
		return RecordUpdate(npc, map[string]interface{}{"pos": tmp11})
	}()
}

func npcWithCounter(npc interface{}, counter interface{}) interface{} {
	return RecordUpdate(npc, map[string]interface{}{"moveCounter": counter})
}

func TryMoveDirection(npc interface{}, dir interface{}, width interface{}, height interface{}) interface{} {
	return func() interface{} {
		dx := directionDx(dir)
		_ = dx // suppress unused
		return func() interface{} {
			dy := directionDy(dir)
			_ = dy // suppress unused
			return func() interface{} {
				newX := func() interface{} {
					tmp15 := npc.(map[string]interface{})["pos"]
					_ = tmp15 // suppress unused
					return func() interface{} {
						tmp16 := tmp15.(map[string]interface{})["x"]
						_ = tmp16 // suppress unused
						return AddInt(tmp16, dx)
					}()
				}()
				_ = newX // suppress unused
				return func() interface{} {
					newY := func() interface{} {
						tmp13 := npc.(map[string]interface{})["pos"]
						_ = tmp13 // suppress unused
						return func() interface{} {
							tmp14 := tmp13.(map[string]interface{})["y"]
							_ = tmp14 // suppress unused
							return AddInt(tmp14, dy)
						}()
					}()
					_ = newY // suppress unused
					return func() interface{} {
						tmp12 := IsInBounds(newX, newY, width, height)
						_ = tmp12 // suppress unused
						return func() interface{} {
							if tmp12.(bool) {
								return npcWithPos(npc, newX, newY)
							}
							return npc
						}()
					}()
				}()
			}()
		}()
	}()
}

func updateRandomWalk(npc interface{}, interval interface{}, width interface{}, height interface{}) interface{} {
	return func() interface{} {
		tmp17 := npc.(map[string]interface{})["moveCounter"]
		_ = tmp17 // suppress unused
		return func() interface{} {
			tmp18 := LeInt(tmp17, 0)
			_ = tmp18 // suppress unused
			return func() interface{} {
				if tmp18.(bool) {
					return func() interface{} {
						dirIndex := handlers.Rand.RandInt(0, 3)
						_ = dirIndex // suppress unused
						return func() interface{} {
							dir := indexToDirection(dirIndex)
							_ = dir // suppress unused
							return func() interface{} {
								movedNpc := TryMoveDirection(npc, dir, width, height)
								_ = movedNpc // suppress unused
								return npcWithCounter(movedNpc, interval)
							}()
						}()
					}()
				}
				return func() interface{} {
					tmp19 := npc.(map[string]interface{})["moveCounter"]
					_ = tmp19 // suppress unused
					return func() interface{} {
						tmp20 := SubInt(tmp19, 1)
						_ = tmp20 // suppress unused
						return npcWithCounter(npc, tmp20)
					}()
				}()
			}()
		}()
	}()
}

func updatePatrol(npc interface{}, path interface{}, width interface{}, height interface{}) interface{} {
	return func() interface{} {
		len := pathLength(path)
		_ = len // suppress unused
		return func() interface{} {
			tmp21 := LeInt(len, 0)
			_ = tmp21 // suppress unused
			return func() interface{} {
				if tmp21.(bool) {
					return npc
				}
				return func() interface{} {
					tmp22 := npc.(map[string]interface{})["moveCounter"]
					_ = tmp22 // suppress unused
					return func() interface{} {
						tmp23 := LeInt(tmp22, 0)
						_ = tmp23 // suppress unused
						return func() interface{} {
							if tmp23.(bool) {
								return func() interface{} {
									dir := func() interface{} {
										tmp26 := npc.(map[string]interface{})["patrolIndex"]
										_ = tmp26 // suppress unused
										return pathGet(path, tmp26)
									}()
									_ = dir // suppress unused
									return func() interface{} {
										movedNpc := TryMoveDirection(npc, dir, width, height)
										_ = movedNpc // suppress unused
										return func() interface{} {
											nextIndex := func() interface{} {
												tmp24 := npc.(map[string]interface{})["patrolIndex"]
												_ = tmp24 // suppress unused
												return func() interface{} {
													tmp25 := AddInt(tmp24, 1)
													_ = tmp25 // suppress unused
													return ModInt(tmp25, len)
												}()
											}()
											_ = nextIndex // suppress unused
											return RecordUpdate(movedNpc, map[string]interface{}{"patrolIndex": nextIndex, "moveCounter": 20})
										}()
									}()
								}()
							}
							return func() interface{} {
								tmp27 := npc.(map[string]interface{})["moveCounter"]
								_ = tmp27 // suppress unused
								return func() interface{} {
									tmp28 := SubInt(tmp27, 1)
									_ = tmp28 // suppress unused
									return npcWithCounter(npc, tmp28)
								}()
							}()
						}()
					}()
				}()
			}()
		}()
	}()
}

func UpdateNPC(npc interface{}, width interface{}, height interface{}) interface{} {
	return func() interface{} {
		tmp29 := npc.(map[string]interface{})["pattern"]
		_ = tmp29 // suppress unused
		return func() interface{} {
			_scrutinee := tmp29
			_ = _scrutinee // suppress unused
			_adt := _scrutinee.(*MovementPattern)
			switch _adt.Kind {
			case MovementPatternKindPatternStatic:
				return npc
			case MovementPatternKindPatternRandomWalk:
				interval := _adt.PatternRandomWalk.Value0
				_ = interval // suppress unused
				return updateRandomWalk(npc, interval, width, height)
			case MovementPatternKindPatternPatrol:
				path := _adt.PatternPatrol.Value0
				_ = path // suppress unused
				return updatePatrol(npc, path, width, height)
			default:
				panic("non-exhaustive match")
			}
		}()
	}()
}

func UpdateAllNPCs(npcs interface{}, width interface{}, height interface{}) interface{} {
	return func() interface{} {
		_scrutinee := npcs
		_ = _scrutinee // suppress unused
		if ListLen(_scrutinee) == 0 {
			return []interface{}{}
		} else if ListLen(_scrutinee) >= 1 {
			npc := ListHead(_scrutinee)
			_ = npc // suppress unused
			rest := ListTail(_scrutinee)
			_ = rest // suppress unused
			return func() interface{} {
				tmp30 := UpdateNPC(npc, width, height)
				_ = tmp30 // suppress unused
				return func() interface{} {
					tmp31 := UpdateAllNPCs(rest, width, height)
					_ = tmp31 // suppress unused
					return Cons(tmp30, tmp31)
				}()
			}()
		} else {
			panic("non-exhaustive match")
		}
	}()
}
