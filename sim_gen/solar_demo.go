// Code generated by ailang. DO NOT EDIT.
package sim_gen

func createMercury_impl(_unused0 interface{}) interface{} {
	return &SolarPlanet{Name: "Mercury", PosX: float64(40), PosY: float64(0), PosZ: float64(0), Radius: float64(2), ColorRgba: int64(2155905279), TextureName: "mercury", Rotation: float64(0), RotationSpeed: float64(0.005), HasRings: false, RingColor: int64(0)}
}

func createMercury() *SolarPlanet {
	return createMercury_impl(struct{}{}).(*SolarPlanet)
}

func createVenus_impl(_unused0 interface{}) interface{} {
	return &SolarPlanet{Name: "Venus", PosX: float64(60), PosY: float64(0), PosZ: float64(0), Radius: float64(4), ColorRgba: int64(3873169663), TextureName: "venus", Rotation: float64(0), RotationSpeed: float64(0.003), HasRings: false, RingColor: int64(0)}
}

func createVenus() *SolarPlanet {
	return createVenus_impl(struct{}{}).(*SolarPlanet)
}

func createEarth_impl(_unused0 interface{}) interface{} {
	return &SolarPlanet{Name: "Earth", PosX: float64(80), PosY: float64(0), PosZ: float64(0), Radius: float64(4.5), ColorRgba: int64(846014719), TextureName: "earth", Rotation: float64(0), RotationSpeed: float64(0.01), HasRings: false, RingColor: int64(0)}
}

func createEarth() *SolarPlanet {
	return createEarth_impl(struct{}{}).(*SolarPlanet)
}

func createMars_impl(_unused0 interface{}) interface{} {
	return &SolarPlanet{Name: "Mars", PosX: float64(100), PosY: float64(0), PosZ: float64(0), Radius: float64(3), ColorRgba: int64(3359519487), TextureName: "mars", Rotation: float64(0), RotationSpeed: float64(0.009), HasRings: false, RingColor: int64(0)}
}

func createMars() *SolarPlanet {
	return createMars_impl(struct{}{}).(*SolarPlanet)
}

func createJupiter_impl(_unused0 interface{}) interface{} {
	return &SolarPlanet{Name: "Jupiter", PosX: float64(150), PosY: float64(0), PosZ: float64(0), Radius: float64(15), ColorRgba: int64(3365143807), TextureName: "jupiter", Rotation: float64(0), RotationSpeed: float64(0.02), HasRings: false, RingColor: int64(0)}
}

func createJupiter() *SolarPlanet {
	return createJupiter_impl(struct{}{}).(*SolarPlanet)
}

func createSaturn_impl(_unused0 interface{}) interface{} {
	return &SolarPlanet{Name: "Saturn", PosX: float64(200), PosY: float64(0), PosZ: float64(0), Radius: float64(12), ColorRgba: int64(3703430399), TextureName: "saturn", Rotation: float64(0), RotationSpeed: float64(0.018), HasRings: true, RingColor: int64(3570993280)}
}

func createSaturn() *SolarPlanet {
	return createSaturn_impl(struct{}{}).(*SolarPlanet)
}

func createUranus_impl(_unused0 interface{}) interface{} {
	return &SolarPlanet{Name: "Uranus", PosX: float64(280), PosY: float64(0), PosZ: float64(0), Radius: float64(8), ColorRgba: int64(2529579775), TextureName: "uranus", Rotation: float64(0), RotationSpeed: float64(0.012), HasRings: true, RingColor: int64(1010763328)}
}

func createUranus() *SolarPlanet {
	return createUranus_impl(struct{}{}).(*SolarPlanet)
}

func createNeptune_impl(_unused0 interface{}) interface{} {
	return &SolarPlanet{Name: "Neptune", PosX: float64(350), PosY: float64(0), PosZ: float64(0), Radius: float64(7), ColorRgba: int64(846014719), TextureName: "neptune", Rotation: float64(0), RotationSpeed: float64(0.011), HasRings: false, RingColor: int64(0)}
}

func createNeptune() *SolarPlanet {
	return createNeptune_impl(struct{}{}).(*SolarPlanet)
}

func createSun_impl(_unused0 interface{}) interface{} {
	return &SolarPlanet{Name: "Sun", PosX: float64(0), PosY: float64(0), PosZ: float64(0), Radius: float64(20), ColorRgba: int64(4290925311), TextureName: "sun", Rotation: float64(0), RotationSpeed: float64(0.001), HasRings: false, RingColor: int64(0)}
}

func createSun() *SolarPlanet {
	return createSun_impl(struct{}{}).(*SolarPlanet)
}

func createPlanets_impl(_unused0 interface{}) interface{} {
	var tmp1 interface{} = createSun_impl(struct{}{})
	var tmp2 interface{} = createMercury_impl(struct{}{})
	var tmp3 interface{} = createVenus_impl(struct{}{})
	var tmp4 interface{} = createEarth_impl(struct{}{})
	var tmp5 interface{} = createMars_impl(struct{}{})
	var tmp6 interface{} = createJupiter_impl(struct{}{})
	var tmp7 interface{} = createSaturn_impl(struct{}{})
	var tmp8 interface{} = createUranus_impl(struct{}{})
	var tmp9 interface{} = createNeptune_impl(struct{}{})
	return []interface{}{tmp1, tmp2, tmp3, tmp4, tmp5, tmp6, tmp7, tmp8, tmp9}
}

func createPlanets() []*SolarPlanet {
	return ConvertToSolarPlanetSlice(createPlanets_impl(struct{}{}))
}

func initSolarDemo_impl(_unused0 interface{}) interface{} {
	return &SolarDemoState{Tick: int64(0), CameraX: float64(300), CameraY: float64(100), CameraZ: float64(200), LookAtX: float64(0), LookAtY: float64(0), LookAtZ: float64(0), ShipVelocity: float64(0), GrEnabled: false, GrCenterX: float64(0.5), GrCenterY: float64(0.5), GrPhi: float64(0.001), SunEnergy: float64(8000), AmbientLevel: float64(0.2)}
}

func InitSolarDemo() *SolarDemoState {
	return initSolarDemo_impl(struct{}{}).(*SolarDemoState)
}

func buildAmbientSettings_impl(level interface{}) interface{} {
	var tmp10 interface{} = &RGBColor{R: float64(0.08), G: float64(0.08), B: float64(0.1)}
	return &AmbientSettings{Energy: level.(float64), Color: tmp10.(*RGBColor)}
}

func buildAmbientSettings(level float64) *AmbientSettings {
	return buildAmbientSettings_impl(level).(*AmbientSettings)
}

func buildSunLight_impl(energy interface{}) interface{} {
	var tmp11 interface{} = &RGBColor{R: float64(1), G: float64(0.95), B: float64(0.85)}
	return &LightSource{Id: "sun", X: float64(0), Y: float64(0), Z: float64(0), Energy: energy.(float64), Color: tmp11.(*RGBColor), Range: float64(0)}
}

func buildSunLight(energy float64) *LightSource {
	return buildSunLight_impl(energy).(*LightSource)
}

func buildLightingContext_impl(sunEnergy interface{}, ambientLevel interface{}) interface{} {
	var tmp12 interface{} = buildAmbientSettings_impl(ambientLevel)
	var tmp13 interface{} = buildSunLight_impl(sunEnergy)
	var tmp14 interface{} = []interface{}{tmp13}
	return &LightingContext{Enabled: true, Ambient: tmp12.(*AmbientSettings), Lights: ConvertToLightSourceSlice(tmp14), LightMultiplier: float64(1)}
}

func buildLightingContext(sunEnergy float64, ambientLevel float64) *LightingContext {
	return buildLightingContext_impl(sunEnergy, ambientLevel).(*LightingContext)
}

func buildSRContext_impl(velocity interface{}) interface{} {
	var tmp15 interface{} = GtFloat(velocity, float64(0.01))
	return &SRContext{Enabled: tmp15.(bool), Velocity: velocity.(float64), Gamma: float64(1), ViewAngle: float64(0)}
}

func buildSRContext(velocity float64) *SRContext {
	return buildSRContext_impl(velocity).(*SRContext)
}

func buildGRContext_impl(enabled interface{}, centerX interface{}, centerY interface{}, phi interface{}) interface{} {
	return &GRContext{Enabled: enabled.(bool), CenterX: centerX.(float64), CenterY: centerY.(float64), Phi: phi.(float64), Rs: float64(0.05), ObjectType: "bh"}
}

func buildGRContext(enabled bool, centerX float64, centerY float64, phi float64) *GRContext {
	return buildGRContext_impl(enabled, centerX, centerY, phi).(*GRContext)
}

func buildRelativityContext_impl(velocity interface{}, grEnabled interface{}, grCenterX interface{}, grCenterY interface{}, grPhi interface{}) interface{} {
	var tmp16 interface{} = buildSRContext_impl(velocity)
	var tmp17 interface{} = buildGRContext_impl(grEnabled, grCenterX, grCenterY, grPhi)
	return &RelativityContext{Sr: tmp16.(*SRContext), Gr: tmp17.(*GRContext)}
}

func buildRelativityContext(velocity float64, grEnabled bool, grCenterX float64, grCenterY float64, grPhi float64) *RelativityContext {
	return buildRelativityContext_impl(velocity, grEnabled, grCenterX, grCenterY, grPhi).(*RelativityContext)
}

func planetToDrawCmd_impl(p interface{}, z interface{}) interface{} {
	var tmp18 interface{} = FieldGet(p, "name")
	var tmp19 interface{} = FieldGet(p, "posX")
	var tmp20 interface{} = FieldGet(p, "posY")
	var tmp21 interface{} = FieldGet(p, "radius")
	var tmp22 interface{} = FieldGet(p, "rotation")
	var tmp23 interface{} = FieldGet(p, "hasRings")
	var tmp24 interface{} = FieldGet(p, "ringColor")
	return NewDrawCmdTexturedPlanet(tmp18.(string), tmp19.(float64), tmp20.(float64), tmp21.(float64), tmp22.(float64), tmp23.(bool), tmp24.(int64), z.(int64))
}

func planetToDrawCmd(p *SolarPlanet, z int64) *DrawCmd {
	return planetToDrawCmd_impl(p, z).(*DrawCmd)
}

func mapPlanetsToDrawCmds_impl(planets interface{}, z interface{}) interface{} {
	return func() interface{} {
		_scrutinee := planets
		_ = _scrutinee // suppress unused
		if ListLen(_scrutinee) == 0 {
			return []interface{}{}
		} else if ListLen(_scrutinee) >= 1 {
			p := ListHead(_scrutinee)
			_ = p // suppress unused
			rest := ListTail(_scrutinee)
			_ = rest // suppress unused
			return func() interface{} {
				var tmp25 interface{} = planetToDrawCmd_impl(p, z)
				_ = tmp25 // suppress unused
				var tmp26 interface{} = mapPlanetsToDrawCmds_impl(rest, z)
				_ = tmp26 // suppress unused
				return Cons(tmp25, tmp26)
			}()
		} else {
			panic("non-exhaustive match")
		}
	}()
}

func mapPlanetsToDrawCmds(planets []*SolarPlanet, z int64) []*DrawCmd {
	return ConvertToDrawCmdSlice(mapPlanetsToDrawCmds_impl(planets, z))
}

func generateDrawCommands_impl(sunEnergy interface{}) interface{} {
	var planets interface{} = createPlanets_impl(struct{}{})
	var bgCmd interface{} = NewDrawCmdSpaceBg(int64(0))
	var planetCmds interface{} = mapPlanetsToDrawCmds_impl(planets, int64(10))
	return Cons(bgCmd, planetCmds)
}

func generateDrawCommands(sunEnergy float64) []*DrawCmd {
	return ConvertToDrawCmdSlice(generateDrawCommands_impl(sunEnergy))
}

func updatePlanetRotation_impl(p interface{}) interface{} {
	var tmp27 interface{} = FieldGet(p, "name")
	var tmp28 interface{} = FieldGet(p, "posX")
	var tmp29 interface{} = FieldGet(p, "posY")
	var tmp30 interface{} = FieldGet(p, "posZ")
	var tmp31 interface{} = FieldGet(p, "radius")
	var tmp32 interface{} = FieldGet(p, "colorRgba")
	var tmp33 interface{} = FieldGet(p, "textureName")
	var tmp34 interface{} = FieldGet(p, "rotation")
	var tmp35 interface{} = FieldGet(p, "rotationSpeed")
	var tmp36 interface{} = AddFloat(tmp34, tmp35)
	var tmp37 interface{} = FieldGet(p, "rotationSpeed")
	var tmp38 interface{} = FieldGet(p, "hasRings")
	var tmp39 interface{} = FieldGet(p, "ringColor")
	return &SolarPlanet{Name: tmp27.(string), PosX: tmp28.(float64), PosY: tmp29.(float64), PosZ: tmp30.(float64), Radius: tmp31.(float64), ColorRgba: tmp32.(int64), TextureName: tmp33.(string), Rotation: tmp36.(float64), RotationSpeed: tmp37.(float64), HasRings: tmp38.(bool), RingColor: tmp39.(int64)}
}

func updatePlanetRotation(p *SolarPlanet) *SolarPlanet {
	return updatePlanetRotation_impl(p).(*SolarPlanet)
}

func updatePlanetRotations_impl(planets interface{}) interface{} {
	return func() interface{} {
		_scrutinee := planets
		_ = _scrutinee // suppress unused
		if ListLen(_scrutinee) == 0 {
			return []interface{}{}
		} else if ListLen(_scrutinee) >= 1 {
			p := ListHead(_scrutinee)
			_ = p // suppress unused
			rest := ListTail(_scrutinee)
			_ = rest // suppress unused
			return func() interface{} {
				var tmp40 interface{} = updatePlanetRotation_impl(p)
				_ = tmp40 // suppress unused
				var tmp41 interface{} = updatePlanetRotations_impl(rest)
				_ = tmp41 // suppress unused
				return Cons(tmp40, tmp41)
			}()
		} else {
			panic("non-exhaustive match")
		}
	}()
}

func updatePlanetRotations(planets []*SolarPlanet) []*SolarPlanet {
	return ConvertToSolarPlanetSlice(updatePlanetRotations_impl(planets))
}

func buildCamera_impl(state interface{}) interface{} {
	var tmp42 interface{} = FieldGet(state, "cameraX")
	var tmp43 interface{} = FieldGet(state, "cameraY")
	return &Camera{X: tmp42.(float64), Y: tmp43.(float64), Zoom: float64(1)}
}

func buildCamera(state *SolarDemoState) *Camera {
	return buildCamera_impl(state).(*Camera)
}

func buildFrameOutput_impl(state interface{}) interface{} {
	var drawCmds interface{} = func() interface{} {
		var tmp54 interface{} = FieldGet(state, "sunEnergy")
		_ = tmp54 // suppress unused
		return generateDrawCommands_impl(tmp54)
	}()
	var lighting interface{} = func() interface{} {
		var tmp52 interface{} = FieldGet(state, "sunEnergy")
		_ = tmp52 // suppress unused
		var tmp53 interface{} = FieldGet(state, "ambientLevel")
		_ = tmp53 // suppress unused
		return buildLightingContext_impl(tmp52, tmp53)
	}()
	var relativity interface{} = func() interface{} {
		var tmp47 interface{} = FieldGet(state, "shipVelocity")
		_ = tmp47 // suppress unused
		var tmp48 interface{} = FieldGet(state, "grEnabled")
		_ = tmp48 // suppress unused
		var tmp49 interface{} = FieldGet(state, "grCenterX")
		_ = tmp49 // suppress unused
		var tmp50 interface{} = FieldGet(state, "grCenterY")
		_ = tmp50 // suppress unused
		var tmp51 interface{} = FieldGet(state, "grPhi")
		_ = tmp51 // suppress unused
		return buildRelativityContext_impl(tmp47, tmp48, tmp49, tmp50, tmp51)
	}()
	var tmp44 interface{} = []interface{}{}
	var tmp45 interface{} = []interface{}{}
	var tmp46 interface{} = buildCamera_impl(state)
	return &FrameOutput{Draw: ConvertToDrawCmdSlice(drawCmds), Sounds: ConvertToInt64Slice(tmp44), Debug: ConvertToStringSlice(tmp45), Camera: tmp46.(*Camera), Relativity: relativity.(*RelativityContext), Lighting: lighting.(*LightingContext)}
}

func buildFrameOutput(state *SolarDemoState) *FrameOutput {
	return buildFrameOutput_impl(state).(*FrameOutput)
}

func incrementTick_impl(state interface{}) interface{} {
	var tmp55 interface{} = FieldGet(state, "tick")
	var tmp56 interface{} = AddInt(tmp55, int64(1))
	var tmp57 interface{} = FieldGet(state, "cameraX")
	var tmp58 interface{} = FieldGet(state, "cameraY")
	var tmp59 interface{} = FieldGet(state, "cameraZ")
	var tmp60 interface{} = FieldGet(state, "lookAtX")
	var tmp61 interface{} = FieldGet(state, "lookAtY")
	var tmp62 interface{} = FieldGet(state, "lookAtZ")
	var tmp63 interface{} = FieldGet(state, "shipVelocity")
	var tmp64 interface{} = FieldGet(state, "grEnabled")
	var tmp65 interface{} = FieldGet(state, "grCenterX")
	var tmp66 interface{} = FieldGet(state, "grCenterY")
	var tmp67 interface{} = FieldGet(state, "grPhi")
	var tmp68 interface{} = FieldGet(state, "sunEnergy")
	var tmp69 interface{} = FieldGet(state, "ambientLevel")
	return &SolarDemoState{Tick: tmp56.(int64), CameraX: tmp57.(float64), CameraY: tmp58.(float64), CameraZ: tmp59.(float64), LookAtX: tmp60.(float64), LookAtY: tmp61.(float64), LookAtZ: tmp62.(float64), ShipVelocity: tmp63.(float64), GrEnabled: tmp64.(bool), GrCenterX: tmp65.(float64), GrCenterY: tmp66.(float64), GrPhi: tmp67.(float64), SunEnergy: tmp68.(float64), AmbientLevel: tmp69.(float64)}
}

func incrementTick(state *SolarDemoState) *SolarDemoState {
	return incrementTick_impl(state).(*SolarDemoState)
}

func stepSolarDemo_impl(state interface{}, input interface{}) interface{} {
	var newState interface{} = incrementTick_impl(state)
	var output interface{} = buildFrameOutput_impl(newState)
	return []interface{}{newState, output}
}

func StepSolarDemo(state *SolarDemoState, input *FrameInput) interface{} {
	return stepSolarDemo_impl(state, input)
}

func getSolarDemoPlanets_impl(_unused0 interface{}) interface{} {
	return createPlanets_impl(struct{}{})
}

func GetSolarDemoPlanets() []*SolarPlanet {
	return ConvertToSolarPlanetSlice(getSolarDemoPlanets_impl(struct{}{}))
}

func getInitialCameraPos_impl(_unused0 interface{}) interface{} {
	return &Vector3{X: float64(300), Y: float64(100), Z: float64(200)}
}

func GetInitialCameraPos() *Vector3 {
	return getInitialCameraPos_impl(struct{}{}).(*Vector3)
}
